Collecting package metadata (current_repodata.json): ...working... done
Solving environment: ...working... done

# All requested packages already installed.

Looking in links: https://download.pytorch.org/whl/torch_stable.html
Requirement already satisfied: torch==1.5.0+cu101 in /home/at2507/miniconda3/lib/python3.8/site-packages (1.5.0+cu101)
Collecting torchvision==0.6.0+cu101
  Using cached https://download.pytorch.org/whl/cu101/torchvision-0.6.0%2Bcu101-cp38-cp38-linux_x86_64.whl (6.6 MB)
Requirement already satisfied: future in /home/at2507/miniconda3/lib/python3.8/site-packages (from torch==1.5.0+cu101) (0.18.2)
Requirement already satisfied: numpy in /home/at2507/miniconda3/lib/python3.8/site-packages (from torch==1.5.0+cu101) (1.18.1)
Requirement already satisfied: pillow>=4.1.1 in /home/at2507/miniconda3/lib/python3.8/site-packages (from torchvision==0.6.0+cu101) (7.2.0)
Installing collected packages: torchvision
  Attempting uninstall: torchvision
    Found existing installation: torchvision 0.5.0
    Uninstalling torchvision-0.5.0:
      Successfully uninstalled torchvision-0.5.0
Successfully installed torchvision-0.6.0+cu101
[{'config': 'experiments/SupsupSeed/splitcifar100/configs/rn18-supsup_3.yaml', 'name': 'id=supsup~seed=0~sparsity=1', 'sparsity': 1, 'seed': 0, 'log-dir': 'runs/SupsupSeed/rn18-supsup_gpu2_num_masks_3', 'epochs': 250, 'data': './data'}, {'config': 'experiments/SupsupSeed/splitcifar100/configs/rn18-supsup_3.yaml', 'name': 'id=supsup~seed=0~sparsity=2', 'sparsity': 2, 'seed': 0, 'log-dir': 'runs/SupsupSeed/rn18-supsup_gpu2_num_masks_3', 'epochs': 250, 'data': './data'}, {'config': 'experiments/SupsupSeed/splitcifar100/configs/rn18-supsup_3.yaml', 'name': 'id=supsup~seed=0~sparsity=4', 'sparsity': 4, 'seed': 0, 'log-dir': 'runs/SupsupSeed/rn18-supsup_gpu2_num_masks_3', 'epochs': 250, 'data': './data'}, {'config': 'experiments/SupsupSeed/splitcifar100/configs/rn18-supsup_3.yaml', 'name': 'id=supsup~seed=0~sparsity=8', 'sparsity': 8, 'seed': 0, 'log-dir': 'runs/SupsupSeed/rn18-supsup_gpu2_num_masks_3', 'epochs': 250, 'data': './data'}, {'config': 'experiments/SupsupSeed/splitcifar100/configs/rn18-supsup_3.yaml', 'name': 'id=supsup~seed=0~sparsity=16', 'sparsity': 16, 'seed': 0, 'log-dir': 'runs/SupsupSeed/rn18-supsup_gpu2_num_masks_3', 'epochs': 250, 'data': './data'}, {'config': 'experiments/SupsupSeed/splitcifar100/configs/rn18-supsup_3.yaml', 'name': 'id=supsup~seed=0~sparsity=32', 'sparsity': 32, 'seed': 0, 'log-dir': 'runs/SupsupSeed/rn18-supsup_gpu2_num_masks_3', 'epochs': 250, 'data': './data'}]
THCudaCheck FAIL file=/pytorch/torch/csrc/cuda/Module.cpp line=59 error=101 : invalid device ordinal
=> Reading YAML config from experiments/SupsupSeed/splitcifar100/configs/rn18-supsup_3.yaml
=> Saving data in runs/SupsupSeed/rn18-supsup_gpu2_num_masks_3/id=supsup~seed=0~sparsity=1~try=2
Files already downloaded and verified
Files already downloaded and verified
[26 86  2 55 75 93 16 73 54 95 53 92 78 13  7 30 22 24 33  8 43 62  3 71
 45 48  6 99 82 76 60 80 90 68 51 27 18 56 63 74  1 61 42 41  4 15 17 40
 38  5 91 59  0 34 28 50 11 35 23 52 10 31 66 57 79 85 32 84 14 89 19 29
 49 97 98 69 20 94 72 77 25 37 81 46 39 65 58 12 88 70 87 36 21 83  9 96
 67 64 47 44]
[26 86  2 55 75]
[93 16 73 54 95]
[53 92 78 13  7]
Set sparsity of conv1 to 0.04259259259259259
Set sparsity of layer1.0.conv1 to 0.011111111111111112
Set sparsity of layer1.0.conv2 to 0.011111111111111112
Set sparsity of layer1.1.conv1 to 0.011111111111111112
Set sparsity of layer1.1.conv2 to 0.011111111111111112
Set sparsity of layer2.0.conv1 to 0.008333333333333333
Set sparsity of layer2.0.conv2 to 0.005555555555555556
Set sparsity of layer2.0.shortcut.0 to 0.075
Set sparsity of layer2.1.conv1 to 0.005555555555555556
Set sparsity of layer2.1.conv2 to 0.005555555555555556
Set sparsity of layer3.0.conv1 to 0.004166666666666667
Set sparsity of layer3.0.conv2 to 0.002777777777777778
Set sparsity of layer3.0.shortcut.0 to 0.0375
Set sparsity of layer3.1.conv1 to 0.002777777777777778
Set sparsity of layer3.1.conv2 to 0.002777777777777778
Set sparsity of layer4.0.conv1 to 0.0020833333333333333
Set sparsity of layer4.0.conv2 to 0.001388888888888889
Set sparsity of layer4.0.shortcut.0 to 0.01875
Set sparsity of layer4.1.conv1 to 0.001388888888888889
Set sparsity of layer4.1.conv2 to 0.001388888888888889
Set sparsity of linear to 0.20625
=> Parallelizing on [2] gpus
Traceback (most recent call last):
  File "main.py", line 425, in <module>
    main()
  File "main.py", line 81, in main
    model = utils.set_gpu(model)
  File "/home/at2507/supsup_team/supsup/utils.py", line 93, in set_gpu
    torch.cuda.set_device(args.multigpu[0])
  File "/home/at2507/miniconda3/lib/python3.8/site-packages/torch/cuda/__init__.py", line 245, in set_device
    torch._C._cuda_setDevice(device)
RuntimeError: cuda runtime error (101) : invalid device ordinal at /pytorch/torch/csrc/cuda/Module.cpp:59
THCudaCheck FAIL file=/pytorch/torch/csrc/cuda/Module.cpp line=59 error=101 : invalid device ordinal
=> Reading YAML config from experiments/SupsupSeed/splitcifar100/configs/rn18-supsup_3.yaml
=> Saving data in runs/SupsupSeed/rn18-supsup_gpu2_num_masks_3/id=supsup~seed=0~sparsity=2~try=2
Files already downloaded and verified
Files already downloaded and verified
[26 86  2 55 75 93 16 73 54 95 53 92 78 13  7 30 22 24 33  8 43 62  3 71
 45 48  6 99 82 76 60 80 90 68 51 27 18 56 63 74  1 61 42 41  4 15 17 40
 38  5 91 59  0 34 28 50 11 35 23 52 10 31 66 57 79 85 32 84 14 89 19 29
 49 97 98 69 20 94 72 77 25 37 81 46 39 65 58 12 88 70 87 36 21 83  9 96
 67 64 47 44]
[26 86  2 55 75]
[93 16 73 54 95]
[53 92 78 13  7]
Set sparsity of conv1 to 0.08518518518518518
Set sparsity of layer1.0.conv1 to 0.022222222222222223
Set sparsity of layer1.0.conv2 to 0.022222222222222223
Set sparsity of layer1.1.conv1 to 0.022222222222222223
Set sparsity of layer1.1.conv2 to 0.022222222222222223
Set sparsity of layer2.0.conv1 to 0.016666666666666666
Set sparsity of layer2.0.conv2 to 0.011111111111111112
Set sparsity of layer2.0.shortcut.0 to 0.15
Set sparsity of layer2.1.conv1 to 0.011111111111111112
Set sparsity of layer2.1.conv2 to 0.011111111111111112
Set sparsity of layer3.0.conv1 to 0.008333333333333333
Set sparsity of layer3.0.conv2 to 0.005555555555555556
Set sparsity of layer3.0.shortcut.0 to 0.075
Set sparsity of layer3.1.conv1 to 0.005555555555555556
Set sparsity of layer3.1.conv2 to 0.005555555555555556
Set sparsity of layer4.0.conv1 to 0.004166666666666667
Set sparsity of layer4.0.conv2 to 0.002777777777777778
Set sparsity of layer4.0.shortcut.0 to 0.0375
Set sparsity of layer4.1.conv1 to 0.002777777777777778
Set sparsity of layer4.1.conv2 to 0.002777777777777778
Set sparsity of linear to 0.4125
=> Parallelizing on [2] gpus
Traceback (most recent call last):
  File "main.py", line 425, in <module>
    main()
  File "main.py", line 81, in main
    model = utils.set_gpu(model)
  File "/home/at2507/supsup_team/supsup/utils.py", line 93, in set_gpu
    torch.cuda.set_device(args.multigpu[0])
  File "/home/at2507/miniconda3/lib/python3.8/site-packages/torch/cuda/__init__.py", line 245, in set_device
    torch._C._cuda_setDevice(device)
RuntimeError: cuda runtime error (101) : invalid device ordinal at /pytorch/torch/csrc/cuda/Module.cpp:59
THCudaCheck FAIL file=/pytorch/torch/csrc/cuda/Module.cpp line=59 error=101 : invalid device ordinal
=> Reading YAML config from experiments/SupsupSeed/splitcifar100/configs/rn18-supsup_3.yaml
=> Saving data in runs/SupsupSeed/rn18-supsup_gpu2_num_masks_3/id=supsup~seed=0~sparsity=4~try=2
Files already downloaded and verified
Files already downloaded and verified
[26 86  2 55 75 93 16 73 54 95 53 92 78 13  7 30 22 24 33  8 43 62  3 71
 45 48  6 99 82 76 60 80 90 68 51 27 18 56 63 74  1 61 42 41  4 15 17 40
 38  5 91 59  0 34 28 50 11 35 23 52 10 31 66 57 79 85 32 84 14 89 19 29
 49 97 98 69 20 94 72 77 25 37 81 46 39 65 58 12 88 70 87 36 21 83  9 96
 67 64 47 44]
[26 86  2 55 75]
[93 16 73 54 95]
[53 92 78 13  7]
Set sparsity of conv1 to 0.17037037037037037
Set sparsity of layer1.0.conv1 to 0.044444444444444446
Set sparsity of layer1.0.conv2 to 0.044444444444444446
Set sparsity of layer1.1.conv1 to 0.044444444444444446
Set sparsity of layer1.1.conv2 to 0.044444444444444446
Set sparsity of layer2.0.conv1 to 0.03333333333333333
Set sparsity of layer2.0.conv2 to 0.022222222222222223
Set sparsity of layer2.0.shortcut.0 to 0.3
Set sparsity of layer2.1.conv1 to 0.022222222222222223
Set sparsity of layer2.1.conv2 to 0.022222222222222223
Set sparsity of layer3.0.conv1 to 0.016666666666666666
Set sparsity of layer3.0.conv2 to 0.011111111111111112
Set sparsity of layer3.0.shortcut.0 to 0.15
Set sparsity of layer3.1.conv1 to 0.011111111111111112
Set sparsity of layer3.1.conv2 to 0.011111111111111112
Set sparsity of layer4.0.conv1 to 0.008333333333333333
Set sparsity of layer4.0.conv2 to 0.005555555555555556
Set sparsity of layer4.0.shortcut.0 to 0.075
Set sparsity of layer4.1.conv1 to 0.005555555555555556
Set sparsity of layer4.1.conv2 to 0.005555555555555556
Set sparsity of linear to 0.5
=> Parallelizing on [2] gpus
Traceback (most recent call last):
  File "main.py", line 425, in <module>
    main()
  File "main.py", line 81, in main
    model = utils.set_gpu(model)
  File "/home/at2507/supsup_team/supsup/utils.py", line 93, in set_gpu
    torch.cuda.set_device(args.multigpu[0])
  File "/home/at2507/miniconda3/lib/python3.8/site-packages/torch/cuda/__init__.py", line 245, in set_device
    torch._C._cuda_setDevice(device)
RuntimeError: cuda runtime error (101) : invalid device ordinal at /pytorch/torch/csrc/cuda/Module.cpp:59
THCudaCheck FAIL file=/pytorch/torch/csrc/cuda/Module.cpp line=59 error=101 : invalid device ordinal
=> Reading YAML config from experiments/SupsupSeed/splitcifar100/configs/rn18-supsup_3.yaml
=> Saving data in runs/SupsupSeed/rn18-supsup_gpu2_num_masks_3/id=supsup~seed=0~sparsity=8~try=2
Files already downloaded and verified
Files already downloaded and verified
[26 86  2 55 75 93 16 73 54 95 53 92 78 13  7 30 22 24 33  8 43 62  3 71
 45 48  6 99 82 76 60 80 90 68 51 27 18 56 63 74  1 61 42 41  4 15 17 40
 38  5 91 59  0 34 28 50 11 35 23 52 10 31 66 57 79 85 32 84 14 89 19 29
 49 97 98 69 20 94 72 77 25 37 81 46 39 65 58 12 88 70 87 36 21 83  9 96
 67 64 47 44]
[26 86  2 55 75]
[93 16 73 54 95]
[53 92 78 13  7]
Set sparsity of conv1 to 0.34074074074074073
Set sparsity of layer1.0.conv1 to 0.08888888888888889
Set sparsity of layer1.0.conv2 to 0.08888888888888889
Set sparsity of layer1.1.conv1 to 0.08888888888888889
Set sparsity of layer1.1.conv2 to 0.08888888888888889
Set sparsity of layer2.0.conv1 to 0.06666666666666667
Set sparsity of layer2.0.conv2 to 0.044444444444444446
Set sparsity of layer2.0.shortcut.0 to 0.5
Set sparsity of layer2.1.conv1 to 0.044444444444444446
Set sparsity of layer2.1.conv2 to 0.044444444444444446
Set sparsity of layer3.0.conv1 to 0.03333333333333333
Set sparsity of layer3.0.conv2 to 0.022222222222222223
Set sparsity of layer3.0.shortcut.0 to 0.3
Set sparsity of layer3.1.conv1 to 0.022222222222222223
Set sparsity of layer3.1.conv2 to 0.022222222222222223
Set sparsity of layer4.0.conv1 to 0.016666666666666666
Set sparsity of layer4.0.conv2 to 0.011111111111111112
Set sparsity of layer4.0.shortcut.0 to 0.15
Set sparsity of layer4.1.conv1 to 0.011111111111111112
Set sparsity of layer4.1.conv2 to 0.011111111111111112
Set sparsity of linear to 0.5
=> Parallelizing on [2] gpus
Traceback (most recent call last):
  File "main.py", line 425, in <module>
    main()
  File "main.py", line 81, in main
    model = utils.set_gpu(model)
  File "/home/at2507/supsup_team/supsup/utils.py", line 93, in set_gpu
    torch.cuda.set_device(args.multigpu[0])
  File "/home/at2507/miniconda3/lib/python3.8/site-packages/torch/cuda/__init__.py", line 245, in set_device
    torch._C._cuda_setDevice(device)
RuntimeError: cuda runtime error (101) : invalid device ordinal at /pytorch/torch/csrc/cuda/Module.cpp:59
THCudaCheck FAIL file=/pytorch/torch/csrc/cuda/Module.cpp line=59 error=101 : invalid device ordinal
=> Reading YAML config from experiments/SupsupSeed/splitcifar100/configs/rn18-supsup_3.yaml
=> Saving data in runs/SupsupSeed/rn18-supsup_gpu2_num_masks_3/id=supsup~seed=0~sparsity=16~try=2
Files already downloaded and verified
Files already downloaded and verified
[26 86  2 55 75 93 16 73 54 95 53 92 78 13  7 30 22 24 33  8 43 62  3 71
 45 48  6 99 82 76 60 80 90 68 51 27 18 56 63 74  1 61 42 41  4 15 17 40
 38  5 91 59  0 34 28 50 11 35 23 52 10 31 66 57 79 85 32 84 14 89 19 29
 49 97 98 69 20 94 72 77 25 37 81 46 39 65 58 12 88 70 87 36 21 83  9 96
 67 64 47 44]
[26 86  2 55 75]
[93 16 73 54 95]
[53 92 78 13  7]
Set sparsity of conv1 to 0.5
Set sparsity of layer1.0.conv1 to 0.17777777777777778
Set sparsity of layer1.0.conv2 to 0.17777777777777778
Set sparsity of layer1.1.conv1 to 0.17777777777777778
Set sparsity of layer1.1.conv2 to 0.17777777777777778
Set sparsity of layer2.0.conv1 to 0.13333333333333333
Set sparsity of layer2.0.conv2 to 0.08888888888888889
Set sparsity of layer2.0.shortcut.0 to 0.5
Set sparsity of layer2.1.conv1 to 0.08888888888888889
Set sparsity of layer2.1.conv2 to 0.08888888888888889
Set sparsity of layer3.0.conv1 to 0.06666666666666667
Set sparsity of layer3.0.conv2 to 0.044444444444444446
Set sparsity of layer3.0.shortcut.0 to 0.5
Set sparsity of layer3.1.conv1 to 0.044444444444444446
Set sparsity of layer3.1.conv2 to 0.044444444444444446
Set sparsity of layer4.0.conv1 to 0.03333333333333333
Set sparsity of layer4.0.conv2 to 0.022222222222222223
Set sparsity of layer4.0.shortcut.0 to 0.3
Set sparsity of layer4.1.conv1 to 0.022222222222222223
Set sparsity of layer4.1.conv2 to 0.022222222222222223
Set sparsity of linear to 0.5
=> Parallelizing on [2] gpus
Traceback (most recent call last):
  File "main.py", line 425, in <module>
    main()
  File "main.py", line 81, in main
    model = utils.set_gpu(model)
  File "/home/at2507/supsup_team/supsup/utils.py", line 93, in set_gpu
    torch.cuda.set_device(args.multigpu[0])
  File "/home/at2507/miniconda3/lib/python3.8/site-packages/torch/cuda/__init__.py", line 245, in set_device
    torch._C._cuda_setDevice(device)
RuntimeError: cuda runtime error (101) : invalid device ordinal at /pytorch/torch/csrc/cuda/Module.cpp:59
THCudaCheck FAIL file=/pytorch/torch/csrc/cuda/Module.cpp line=59 error=101 : invalid device ordinal
=> Reading YAML config from experiments/SupsupSeed/splitcifar100/configs/rn18-supsup_3.yaml
=> Saving data in runs/SupsupSeed/rn18-supsup_gpu2_num_masks_3/id=supsup~seed=0~sparsity=32~try=2
Files already downloaded and verified
Files already downloaded and verified
[26 86  2 55 75 93 16 73 54 95 53 92 78 13  7 30 22 24 33  8 43 62  3 71
 45 48  6 99 82 76 60 80 90 68 51 27 18 56 63 74  1 61 42 41  4 15 17 40
 38  5 91 59  0 34 28 50 11 35 23 52 10 31 66 57 79 85 32 84 14 89 19 29
 49 97 98 69 20 94 72 77 25 37 81 46 39 65 58 12 88 70 87 36 21 83  9 96
 67 64 47 44]
[26 86  2 55 75]
[93 16 73 54 95]
[53 92 78 13  7]
Set sparsity of conv1 to 0.5
Set sparsity of layer1.0.conv1 to 0.35555555555555557
Set sparsity of layer1.0.conv2 to 0.35555555555555557
Set sparsity of layer1.1.conv1 to 0.35555555555555557
Set sparsity of layer1.1.conv2 to 0.35555555555555557
Set sparsity of layer2.0.conv1 to 0.26666666666666666
Set sparsity of layer2.0.conv2 to 0.17777777777777778
Set sparsity of layer2.0.shortcut.0 to 0.5
Set sparsity of layer2.1.conv1 to 0.17777777777777778
Set sparsity of layer2.1.conv2 to 0.17777777777777778
Set sparsity of layer3.0.conv1 to 0.13333333333333333
Set sparsity of layer3.0.conv2 to 0.08888888888888889
Set sparsity of layer3.0.shortcut.0 to 0.5
Set sparsity of layer3.1.conv1 to 0.08888888888888889
Set sparsity of layer3.1.conv2 to 0.08888888888888889
Set sparsity of layer4.0.conv1 to 0.06666666666666667
Set sparsity of layer4.0.conv2 to 0.044444444444444446
Set sparsity of layer4.0.shortcut.0 to 0.5
Set sparsity of layer4.1.conv1 to 0.044444444444444446
Set sparsity of layer4.1.conv2 to 0.044444444444444446
Set sparsity of linear to 0.5
=> Parallelizing on [2] gpus
Traceback (most recent call last):
  File "main.py", line 425, in <module>
    main()
  File "main.py", line 81, in main
    model = utils.set_gpu(model)
  File "/home/at2507/supsup_team/supsup/utils.py", line 93, in set_gpu
    torch.cuda.set_device(args.multigpu[0])
  File "/home/at2507/miniconda3/lib/python3.8/site-packages/torch/cuda/__init__.py", line 245, in set_device
    torch._C._cuda_setDevice(device)
RuntimeError: cuda runtime error (101) : invalid device ordinal at /pytorch/torch/csrc/cuda/Module.cpp:59
==> Starting experiment python main.py --config=experiments/SupsupSeed/splitcifar100/configs/rn18-supsup_3.yaml --name=id=supsup~seed=0~sparsity=1 --sparsity=1 --seed=0 --log-dir=runs/SupsupSeed/rn18-supsup_gpu2_num_masks_3 --epochs=250 --data=./data --multigpu=2 
==> Starting experiment python main.py --config=experiments/SupsupSeed/splitcifar100/configs/rn18-supsup_3.yaml --name=id=supsup~seed=0~sparsity=2 --sparsity=2 --seed=0 --log-dir=runs/SupsupSeed/rn18-supsup_gpu2_num_masks_3 --epochs=250 --data=./data --multigpu=2 
==> Starting experiment python main.py --config=experiments/SupsupSeed/splitcifar100/configs/rn18-supsup_3.yaml --name=id=supsup~seed=0~sparsity=4 --sparsity=4 --seed=0 --log-dir=runs/SupsupSeed/rn18-supsup_gpu2_num_masks_3 --epochs=250 --data=./data --multigpu=2 
==> Starting experiment python main.py --config=experiments/SupsupSeed/splitcifar100/configs/rn18-supsup_3.yaml --name=id=supsup~seed=0~sparsity=8 --sparsity=8 --seed=0 --log-dir=runs/SupsupSeed/rn18-supsup_gpu2_num_masks_3 --epochs=250 --data=./data --multigpu=2 
==> Starting experiment python main.py --config=experiments/SupsupSeed/splitcifar100/configs/rn18-supsup_3.yaml --name=id=supsup~seed=0~sparsity=16 --sparsity=16 --seed=0 --log-dir=runs/SupsupSeed/rn18-supsup_gpu2_num_masks_3 --epochs=250 --data=./data --multigpu=2 
==> Starting experiment python main.py --config=experiments/SupsupSeed/splitcifar100/configs/rn18-supsup_3.yaml --name=id=supsup~seed=0~sparsity=32 --sparsity=32 --seed=0 --log-dir=runs/SupsupSeed/rn18-supsup_gpu2_num_masks_3 --epochs=250 --data=./data --multigpu=2 
[{'config': 'experiments/SupsupSeed/splitcifar100/configs/rn18-supsup_5.yaml', 'name': 'id=supsup~seed=0~sparsity=1', 'sparsity': 1, 'seed': 0, 'log-dir': 'runs/SupsupSeed/rn18-supsup_gpu2_num_masks_5', 'epochs': 250, 'data': './data'}, {'config': 'experiments/SupsupSeed/splitcifar100/configs/rn18-supsup_5.yaml', 'name': 'id=supsup~seed=0~sparsity=2', 'sparsity': 2, 'seed': 0, 'log-dir': 'runs/SupsupSeed/rn18-supsup_gpu2_num_masks_5', 'epochs': 250, 'data': './data'}, {'config': 'experiments/SupsupSeed/splitcifar100/configs/rn18-supsup_5.yaml', 'name': 'id=supsup~seed=0~sparsity=4', 'sparsity': 4, 'seed': 0, 'log-dir': 'runs/SupsupSeed/rn18-supsup_gpu2_num_masks_5', 'epochs': 250, 'data': './data'}, {'config': 'experiments/SupsupSeed/splitcifar100/configs/rn18-supsup_5.yaml', 'name': 'id=supsup~seed=0~sparsity=8', 'sparsity': 8, 'seed': 0, 'log-dir': 'runs/SupsupSeed/rn18-supsup_gpu2_num_masks_5', 'epochs': 250, 'data': './data'}, {'config': 'experiments/SupsupSeed/splitcifar100/configs/rn18-supsup_5.yaml', 'name': 'id=supsup~seed=0~sparsity=16', 'sparsity': 16, 'seed': 0, 'log-dir': 'runs/SupsupSeed/rn18-supsup_gpu2_num_masks_5', 'epochs': 250, 'data': './data'}, {'config': 'experiments/SupsupSeed/splitcifar100/configs/rn18-supsup_5.yaml', 'name': 'id=supsup~seed=0~sparsity=32', 'sparsity': 32, 'seed': 0, 'log-dir': 'runs/SupsupSeed/rn18-supsup_gpu2_num_masks_5', 'epochs': 250, 'data': './data'}]
THCudaCheck FAIL file=/pytorch/torch/csrc/cuda/Module.cpp line=59 error=101 : invalid device ordinal
=> Reading YAML config from experiments/SupsupSeed/splitcifar100/configs/rn18-supsup_5.yaml
=> Saving data in runs/SupsupSeed/rn18-supsup_gpu2_num_masks_5/id=supsup~seed=0~sparsity=1~try=2
Files already downloaded and verified
Files already downloaded and verified
[26 86  2 55 75 93 16 73 54 95 53 92 78 13  7 30 22 24 33  8 43 62  3 71
 45 48  6 99 82 76 60 80 90 68 51 27 18 56 63 74  1 61 42 41  4 15 17 40
 38  5 91 59  0 34 28 50 11 35 23 52 10 31 66 57 79 85 32 84 14 89 19 29
 49 97 98 69 20 94 72 77 25 37 81 46 39 65 58 12 88 70 87 36 21 83  9 96
 67 64 47 44]
[26 86  2 55 75]
[93 16 73 54 95]
[53 92 78 13  7]
[30 22 24 33  8]
[43 62  3 71 45]
Set sparsity of conv1 to 0.04259259259259259
Set sparsity of layer1.0.conv1 to 0.011111111111111112
Set sparsity of layer1.0.conv2 to 0.011111111111111112
Set sparsity of layer1.1.conv1 to 0.011111111111111112
Set sparsity of layer1.1.conv2 to 0.011111111111111112
Set sparsity of layer2.0.conv1 to 0.008333333333333333
Set sparsity of layer2.0.conv2 to 0.005555555555555556
Set sparsity of layer2.0.shortcut.0 to 0.075
Set sparsity of layer2.1.conv1 to 0.005555555555555556
Set sparsity of layer2.1.conv2 to 0.005555555555555556
Set sparsity of layer3.0.conv1 to 0.004166666666666667
Set sparsity of layer3.0.conv2 to 0.002777777777777778
Set sparsity of layer3.0.shortcut.0 to 0.0375
Set sparsity of layer3.1.conv1 to 0.002777777777777778
Set sparsity of layer3.1.conv2 to 0.002777777777777778
Set sparsity of layer4.0.conv1 to 0.0020833333333333333
Set sparsity of layer4.0.conv2 to 0.001388888888888889
Set sparsity of layer4.0.shortcut.0 to 0.01875
Set sparsity of layer4.1.conv1 to 0.001388888888888889
Set sparsity of layer4.1.conv2 to 0.001388888888888889
Set sparsity of linear to 0.20625
=> Parallelizing on [2] gpus
Traceback (most recent call last):
  File "main.py", line 425, in <module>
    main()
  File "main.py", line 81, in main
    model = utils.set_gpu(model)
  File "/home/at2507/supsup_team/supsup/utils.py", line 93, in set_gpu
    torch.cuda.set_device(args.multigpu[0])
  File "/home/at2507/miniconda3/lib/python3.8/site-packages/torch/cuda/__init__.py", line 245, in set_device
    torch._C._cuda_setDevice(device)
RuntimeError: cuda runtime error (101) : invalid device ordinal at /pytorch/torch/csrc/cuda/Module.cpp:59
THCudaCheck FAIL file=/pytorch/torch/csrc/cuda/Module.cpp line=59 error=101 : invalid device ordinal
=> Reading YAML config from experiments/SupsupSeed/splitcifar100/configs/rn18-supsup_5.yaml
=> Saving data in runs/SupsupSeed/rn18-supsup_gpu2_num_masks_5/id=supsup~seed=0~sparsity=2~try=2
Files already downloaded and verified
Files already downloaded and verified
[26 86  2 55 75 93 16 73 54 95 53 92 78 13  7 30 22 24 33  8 43 62  3 71
 45 48  6 99 82 76 60 80 90 68 51 27 18 56 63 74  1 61 42 41  4 15 17 40
 38  5 91 59  0 34 28 50 11 35 23 52 10 31 66 57 79 85 32 84 14 89 19 29
 49 97 98 69 20 94 72 77 25 37 81 46 39 65 58 12 88 70 87 36 21 83  9 96
 67 64 47 44]
[26 86  2 55 75]
[93 16 73 54 95]
[53 92 78 13  7]
[30 22 24 33  8]
[43 62  3 71 45]
Set sparsity of conv1 to 0.08518518518518518
Set sparsity of layer1.0.conv1 to 0.022222222222222223
Set sparsity of layer1.0.conv2 to 0.022222222222222223
Set sparsity of layer1.1.conv1 to 0.022222222222222223
Set sparsity of layer1.1.conv2 to 0.022222222222222223
Set sparsity of layer2.0.conv1 to 0.016666666666666666
Set sparsity of layer2.0.conv2 to 0.011111111111111112
Set sparsity of layer2.0.shortcut.0 to 0.15
Set sparsity of layer2.1.conv1 to 0.011111111111111112
Set sparsity of layer2.1.conv2 to 0.011111111111111112
Set sparsity of layer3.0.conv1 to 0.008333333333333333
Set sparsity of layer3.0.conv2 to 0.005555555555555556
Set sparsity of layer3.0.shortcut.0 to 0.075
Set sparsity of layer3.1.conv1 to 0.005555555555555556
Set sparsity of layer3.1.conv2 to 0.005555555555555556
Set sparsity of layer4.0.conv1 to 0.004166666666666667
Set sparsity of layer4.0.conv2 to 0.002777777777777778
Set sparsity of layer4.0.shortcut.0 to 0.0375
Set sparsity of layer4.1.conv1 to 0.002777777777777778
Set sparsity of layer4.1.conv2 to 0.002777777777777778
Set sparsity of linear to 0.4125
=> Parallelizing on [2] gpus
Traceback (most recent call last):
  File "main.py", line 425, in <module>
    main()
  File "main.py", line 81, in main
    model = utils.set_gpu(model)
  File "/home/at2507/supsup_team/supsup/utils.py", line 93, in set_gpu
    torch.cuda.set_device(args.multigpu[0])
  File "/home/at2507/miniconda3/lib/python3.8/site-packages/torch/cuda/__init__.py", line 245, in set_device
    torch._C._cuda_setDevice(device)
RuntimeError: cuda runtime error (101) : invalid device ordinal at /pytorch/torch/csrc/cuda/Module.cpp:59
THCudaCheck FAIL file=/pytorch/torch/csrc/cuda/Module.cpp line=59 error=101 : invalid device ordinal
=> Reading YAML config from experiments/SupsupSeed/splitcifar100/configs/rn18-supsup_5.yaml
=> Saving data in runs/SupsupSeed/rn18-supsup_gpu2_num_masks_5/id=supsup~seed=0~sparsity=4~try=2
Files already downloaded and verified
Files already downloaded and verified
[26 86  2 55 75 93 16 73 54 95 53 92 78 13  7 30 22 24 33  8 43 62  3 71
 45 48  6 99 82 76 60 80 90 68 51 27 18 56 63 74  1 61 42 41  4 15 17 40
 38  5 91 59  0 34 28 50 11 35 23 52 10 31 66 57 79 85 32 84 14 89 19 29
 49 97 98 69 20 94 72 77 25 37 81 46 39 65 58 12 88 70 87 36 21 83  9 96
 67 64 47 44]
[26 86  2 55 75]
[93 16 73 54 95]
[53 92 78 13  7]
[30 22 24 33  8]
[43 62  3 71 45]
Set sparsity of conv1 to 0.17037037037037037
Set sparsity of layer1.0.conv1 to 0.044444444444444446
Set sparsity of layer1.0.conv2 to 0.044444444444444446
Set sparsity of layer1.1.conv1 to 0.044444444444444446
Set sparsity of layer1.1.conv2 to 0.044444444444444446
Set sparsity of layer2.0.conv1 to 0.03333333333333333
Set sparsity of layer2.0.conv2 to 0.022222222222222223
Set sparsity of layer2.0.shortcut.0 to 0.3
Set sparsity of layer2.1.conv1 to 0.022222222222222223
Set sparsity of layer2.1.conv2 to 0.022222222222222223
Set sparsity of layer3.0.conv1 to 0.016666666666666666
Set sparsity of layer3.0.conv2 to 0.011111111111111112
Set sparsity of layer3.0.shortcut.0 to 0.15
Set sparsity of layer3.1.conv1 to 0.011111111111111112
Set sparsity of layer3.1.conv2 to 0.011111111111111112
Set sparsity of layer4.0.conv1 to 0.008333333333333333
Set sparsity of layer4.0.conv2 to 0.005555555555555556
Set sparsity of layer4.0.shortcut.0 to 0.075
Set sparsity of layer4.1.conv1 to 0.005555555555555556
Set sparsity of layer4.1.conv2 to 0.005555555555555556
Set sparsity of linear to 0.5
=> Parallelizing on [2] gpus
Traceback (most recent call last):
  File "main.py", line 425, in <module>
    main()
  File "main.py", line 81, in main
    model = utils.set_gpu(model)
  File "/home/at2507/supsup_team/supsup/utils.py", line 93, in set_gpu
    torch.cuda.set_device(args.multigpu[0])
  File "/home/at2507/miniconda3/lib/python3.8/site-packages/torch/cuda/__init__.py", line 245, in set_device
    torch._C._cuda_setDevice(device)
RuntimeError: cuda runtime error (101) : invalid device ordinal at /pytorch/torch/csrc/cuda/Module.cpp:59
THCudaCheck FAIL file=/pytorch/torch/csrc/cuda/Module.cpp line=59 error=101 : invalid device ordinal
=> Reading YAML config from experiments/SupsupSeed/splitcifar100/configs/rn18-supsup_5.yaml
=> Saving data in runs/SupsupSeed/rn18-supsup_gpu2_num_masks_5/id=supsup~seed=0~sparsity=8~try=2
Files already downloaded and verified
Files already downloaded and verified
[26 86  2 55 75 93 16 73 54 95 53 92 78 13  7 30 22 24 33  8 43 62  3 71
 45 48  6 99 82 76 60 80 90 68 51 27 18 56 63 74  1 61 42 41  4 15 17 40
 38  5 91 59  0 34 28 50 11 35 23 52 10 31 66 57 79 85 32 84 14 89 19 29
 49 97 98 69 20 94 72 77 25 37 81 46 39 65 58 12 88 70 87 36 21 83  9 96
 67 64 47 44]
[26 86  2 55 75]
[93 16 73 54 95]
[53 92 78 13  7]
[30 22 24 33  8]
[43 62  3 71 45]
Set sparsity of conv1 to 0.34074074074074073
Set sparsity of layer1.0.conv1 to 0.08888888888888889
Set sparsity of layer1.0.conv2 to 0.08888888888888889
Set sparsity of layer1.1.conv1 to 0.08888888888888889
Set sparsity of layer1.1.conv2 to 0.08888888888888889
Set sparsity of layer2.0.conv1 to 0.06666666666666667
Set sparsity of layer2.0.conv2 to 0.044444444444444446
Set sparsity of layer2.0.shortcut.0 to 0.5
Set sparsity of layer2.1.conv1 to 0.044444444444444446
Set sparsity of layer2.1.conv2 to 0.044444444444444446
Set sparsity of layer3.0.conv1 to 0.03333333333333333
Set sparsity of layer3.0.conv2 to 0.022222222222222223
Set sparsity of layer3.0.shortcut.0 to 0.3
Set sparsity of layer3.1.conv1 to 0.022222222222222223
Set sparsity of layer3.1.conv2 to 0.022222222222222223
Set sparsity of layer4.0.conv1 to 0.016666666666666666
Set sparsity of layer4.0.conv2 to 0.011111111111111112
Set sparsity of layer4.0.shortcut.0 to 0.15
Set sparsity of layer4.1.conv1 to 0.011111111111111112
Set sparsity of layer4.1.conv2 to 0.011111111111111112
Set sparsity of linear to 0.5
=> Parallelizing on [2] gpus
Traceback (most recent call last):
  File "main.py", line 425, in <module>
    main()
  File "main.py", line 81, in main
    model = utils.set_gpu(model)
  File "/home/at2507/supsup_team/supsup/utils.py", line 93, in set_gpu
    torch.cuda.set_device(args.multigpu[0])
  File "/home/at2507/miniconda3/lib/python3.8/site-packages/torch/cuda/__init__.py", line 245, in set_device
    torch._C._cuda_setDevice(device)
RuntimeError: cuda runtime error (101) : invalid device ordinal at /pytorch/torch/csrc/cuda/Module.cpp:59
THCudaCheck FAIL file=/pytorch/torch/csrc/cuda/Module.cpp line=59 error=101 : invalid device ordinal
=> Reading YAML config from experiments/SupsupSeed/splitcifar100/configs/rn18-supsup_5.yaml
=> Saving data in runs/SupsupSeed/rn18-supsup_gpu2_num_masks_5/id=supsup~seed=0~sparsity=16~try=2
Files already downloaded and verified
Files already downloaded and verified
[26 86  2 55 75 93 16 73 54 95 53 92 78 13  7 30 22 24 33  8 43 62  3 71
 45 48  6 99 82 76 60 80 90 68 51 27 18 56 63 74  1 61 42 41  4 15 17 40
 38  5 91 59  0 34 28 50 11 35 23 52 10 31 66 57 79 85 32 84 14 89 19 29
 49 97 98 69 20 94 72 77 25 37 81 46 39 65 58 12 88 70 87 36 21 83  9 96
 67 64 47 44]
[26 86  2 55 75]
[93 16 73 54 95]
[53 92 78 13  7]
[30 22 24 33  8]
[43 62  3 71 45]
Set sparsity of conv1 to 0.5
Set sparsity of layer1.0.conv1 to 0.17777777777777778
Set sparsity of layer1.0.conv2 to 0.17777777777777778
Set sparsity of layer1.1.conv1 to 0.17777777777777778
Set sparsity of layer1.1.conv2 to 0.17777777777777778
Set sparsity of layer2.0.conv1 to 0.13333333333333333
Set sparsity of layer2.0.conv2 to 0.08888888888888889
Set sparsity of layer2.0.shortcut.0 to 0.5
Set sparsity of layer2.1.conv1 to 0.08888888888888889
Set sparsity of layer2.1.conv2 to 0.08888888888888889
Set sparsity of layer3.0.conv1 to 0.06666666666666667
Set sparsity of layer3.0.conv2 to 0.044444444444444446
Set sparsity of layer3.0.shortcut.0 to 0.5
Set sparsity of layer3.1.conv1 to 0.044444444444444446
Set sparsity of layer3.1.conv2 to 0.044444444444444446
Set sparsity of layer4.0.conv1 to 0.03333333333333333
Set sparsity of layer4.0.conv2 to 0.022222222222222223
Set sparsity of layer4.0.shortcut.0 to 0.3
Set sparsity of layer4.1.conv1 to 0.022222222222222223
Set sparsity of layer4.1.conv2 to 0.022222222222222223
Set sparsity of linear to 0.5
=> Parallelizing on [2] gpus
Traceback (most recent call last):
  File "main.py", line 425, in <module>
    main()
  File "main.py", line 81, in main
    model = utils.set_gpu(model)
  File "/home/at2507/supsup_team/supsup/utils.py", line 93, in set_gpu
    torch.cuda.set_device(args.multigpu[0])
  File "/home/at2507/miniconda3/lib/python3.8/site-packages/torch/cuda/__init__.py", line 245, in set_device
    torch._C._cuda_setDevice(device)
RuntimeError: cuda runtime error (101) : invalid device ordinal at /pytorch/torch/csrc/cuda/Module.cpp:59
THCudaCheck FAIL file=/pytorch/torch/csrc/cuda/Module.cpp line=59 error=101 : invalid device ordinal
=> Reading YAML config from experiments/SupsupSeed/splitcifar100/configs/rn18-supsup_5.yaml
=> Saving data in runs/SupsupSeed/rn18-supsup_gpu2_num_masks_5/id=supsup~seed=0~sparsity=32~try=2
Files already downloaded and verified
Files already downloaded and verified
[26 86  2 55 75 93 16 73 54 95 53 92 78 13  7 30 22 24 33  8 43 62  3 71
 45 48  6 99 82 76 60 80 90 68 51 27 18 56 63 74  1 61 42 41  4 15 17 40
 38  5 91 59  0 34 28 50 11 35 23 52 10 31 66 57 79 85 32 84 14 89 19 29
 49 97 98 69 20 94 72 77 25 37 81 46 39 65 58 12 88 70 87 36 21 83  9 96
 67 64 47 44]
[26 86  2 55 75]
[93 16 73 54 95]
[53 92 78 13  7]
[30 22 24 33  8]
[43 62  3 71 45]
Set sparsity of conv1 to 0.5
Set sparsity of layer1.0.conv1 to 0.35555555555555557
Set sparsity of layer1.0.conv2 to 0.35555555555555557
Set sparsity of layer1.1.conv1 to 0.35555555555555557
Set sparsity of layer1.1.conv2 to 0.35555555555555557
Set sparsity of layer2.0.conv1 to 0.26666666666666666
Set sparsity of layer2.0.conv2 to 0.17777777777777778
Set sparsity of layer2.0.shortcut.0 to 0.5
Set sparsity of layer2.1.conv1 to 0.17777777777777778
Set sparsity of layer2.1.conv2 to 0.17777777777777778
Set sparsity of layer3.0.conv1 to 0.13333333333333333
Set sparsity of layer3.0.conv2 to 0.08888888888888889
Set sparsity of layer3.0.shortcut.0 to 0.5
Set sparsity of layer3.1.conv1 to 0.08888888888888889
Set sparsity of layer3.1.conv2 to 0.08888888888888889
Set sparsity of layer4.0.conv1 to 0.06666666666666667
Set sparsity of layer4.0.conv2 to 0.044444444444444446
Set sparsity of layer4.0.shortcut.0 to 0.5
Set sparsity of layer4.1.conv1 to 0.044444444444444446
Set sparsity of layer4.1.conv2 to 0.044444444444444446
Set sparsity of linear to 0.5
=> Parallelizing on [2] gpus
Traceback (most recent call last):
  File "main.py", line 425, in <module>
    main()
  File "main.py", line 81, in main
    model = utils.set_gpu(model)
  File "/home/at2507/supsup_team/supsup/utils.py", line 93, in set_gpu
    torch.cuda.set_device(args.multigpu[0])
  File "/home/at2507/miniconda3/lib/python3.8/site-packages/torch/cuda/__init__.py", line 245, in set_device
    torch._C._cuda_setDevice(device)
RuntimeError: cuda runtime error (101) : invalid device ordinal at /pytorch/torch/csrc/cuda/Module.cpp:59
==> Starting experiment python main.py --config=experiments/SupsupSeed/splitcifar100/configs/rn18-supsup_5.yaml --name=id=supsup~seed=0~sparsity=1 --sparsity=1 --seed=0 --log-dir=runs/SupsupSeed/rn18-supsup_gpu2_num_masks_5 --epochs=250 --data=./data --multigpu=2 
==> Starting experiment python main.py --config=experiments/SupsupSeed/splitcifar100/configs/rn18-supsup_5.yaml --name=id=supsup~seed=0~sparsity=2 --sparsity=2 --seed=0 --log-dir=runs/SupsupSeed/rn18-supsup_gpu2_num_masks_5 --epochs=250 --data=./data --multigpu=2 
==> Starting experiment python main.py --config=experiments/SupsupSeed/splitcifar100/configs/rn18-supsup_5.yaml --name=id=supsup~seed=0~sparsity=4 --sparsity=4 --seed=0 --log-dir=runs/SupsupSeed/rn18-supsup_gpu2_num_masks_5 --epochs=250 --data=./data --multigpu=2 
==> Starting experiment python main.py --config=experiments/SupsupSeed/splitcifar100/configs/rn18-supsup_5.yaml --name=id=supsup~seed=0~sparsity=8 --sparsity=8 --seed=0 --log-dir=runs/SupsupSeed/rn18-supsup_gpu2_num_masks_5 --epochs=250 --data=./data --multigpu=2 
==> Starting experiment python main.py --config=experiments/SupsupSeed/splitcifar100/configs/rn18-supsup_5.yaml --name=id=supsup~seed=0~sparsity=16 --sparsity=16 --seed=0 --log-dir=runs/SupsupSeed/rn18-supsup_gpu2_num_masks_5 --epochs=250 --data=./data --multigpu=2 
==> Starting experiment python main.py --config=experiments/SupsupSeed/splitcifar100/configs/rn18-supsup_5.yaml --name=id=supsup~seed=0~sparsity=32 --sparsity=32 --seed=0 --log-dir=runs/SupsupSeed/rn18-supsup_gpu2_num_masks_5 --epochs=250 --data=./data --multigpu=2 
[{'config': 'experiments/SupsupSeed/splitcifar100/configs/rn18-supsup_7.yaml', 'name': 'id=supsup~seed=0~sparsity=1', 'sparsity': 1, 'seed': 0, 'log-dir': 'runs/SupsupSeed/rn18-supsup_gpu2_num_masks_7', 'epochs': 250, 'data': './data'}, {'config': 'experiments/SupsupSeed/splitcifar100/configs/rn18-supsup_7.yaml', 'name': 'id=supsup~seed=0~sparsity=2', 'sparsity': 2, 'seed': 0, 'log-dir': 'runs/SupsupSeed/rn18-supsup_gpu2_num_masks_7', 'epochs': 250, 'data': './data'}, {'config': 'experiments/SupsupSeed/splitcifar100/configs/rn18-supsup_7.yaml', 'name': 'id=supsup~seed=0~sparsity=4', 'sparsity': 4, 'seed': 0, 'log-dir': 'runs/SupsupSeed/rn18-supsup_gpu2_num_masks_7', 'epochs': 250, 'data': './data'}, {'config': 'experiments/SupsupSeed/splitcifar100/configs/rn18-supsup_7.yaml', 'name': 'id=supsup~seed=0~sparsity=8', 'sparsity': 8, 'seed': 0, 'log-dir': 'runs/SupsupSeed/rn18-supsup_gpu2_num_masks_7', 'epochs': 250, 'data': './data'}, {'config': 'experiments/SupsupSeed/splitcifar100/configs/rn18-supsup_7.yaml', 'name': 'id=supsup~seed=0~sparsity=16', 'sparsity': 16, 'seed': 0, 'log-dir': 'runs/SupsupSeed/rn18-supsup_gpu2_num_masks_7', 'epochs': 250, 'data': './data'}, {'config': 'experiments/SupsupSeed/splitcifar100/configs/rn18-supsup_7.yaml', 'name': 'id=supsup~seed=0~sparsity=32', 'sparsity': 32, 'seed': 0, 'log-dir': 'runs/SupsupSeed/rn18-supsup_gpu2_num_masks_7', 'epochs': 250, 'data': './data'}]
THCudaCheck FAIL file=/pytorch/torch/csrc/cuda/Module.cpp line=59 error=101 : invalid device ordinal
=> Reading YAML config from experiments/SupsupSeed/splitcifar100/configs/rn18-supsup_7.yaml
=> Saving data in runs/SupsupSeed/rn18-supsup_gpu2_num_masks_7/id=supsup~seed=0~sparsity=1~try=2
Files already downloaded and verified
Files already downloaded and verified
[26 86  2 55 75 93 16 73 54 95 53 92 78 13  7 30 22 24 33  8 43 62  3 71
 45 48  6 99 82 76 60 80 90 68 51 27 18 56 63 74  1 61 42 41  4 15 17 40
 38  5 91 59  0 34 28 50 11 35 23 52 10 31 66 57 79 85 32 84 14 89 19 29
 49 97 98 69 20 94 72 77 25 37 81 46 39 65 58 12 88 70 87 36 21 83  9 96
 67 64 47 44]
[26 86  2 55 75]
[93 16 73 54 95]
[53 92 78 13  7]
[30 22 24 33  8]
[43 62  3 71 45]
[48  6 99 82 76]
[60 80 90 68 51]
Set sparsity of conv1 to 0.04259259259259259
Set sparsity of layer1.0.conv1 to 0.011111111111111112
Set sparsity of layer1.0.conv2 to 0.011111111111111112
Set sparsity of layer1.1.conv1 to 0.011111111111111112
Set sparsity of layer1.1.conv2 to 0.011111111111111112
Set sparsity of layer2.0.conv1 to 0.008333333333333333
Set sparsity of layer2.0.conv2 to 0.005555555555555556
Set sparsity of layer2.0.shortcut.0 to 0.075
Set sparsity of layer2.1.conv1 to 0.005555555555555556
Set sparsity of layer2.1.conv2 to 0.005555555555555556
Set sparsity of layer3.0.conv1 to 0.004166666666666667
Set sparsity of layer3.0.conv2 to 0.002777777777777778
Set sparsity of layer3.0.shortcut.0 to 0.0375
Set sparsity of layer3.1.conv1 to 0.002777777777777778
Set sparsity of layer3.1.conv2 to 0.002777777777777778
Set sparsity of layer4.0.conv1 to 0.0020833333333333333
Set sparsity of layer4.0.conv2 to 0.001388888888888889
Set sparsity of layer4.0.shortcut.0 to 0.01875
Set sparsity of layer4.1.conv1 to 0.001388888888888889
Set sparsity of layer4.1.conv2 to 0.001388888888888889
Set sparsity of linear to 0.20625
=> Parallelizing on [2] gpus
Traceback (most recent call last):
  File "main.py", line 425, in <module>
    main()
  File "main.py", line 81, in main
    model = utils.set_gpu(model)
  File "/home/at2507/supsup_team/supsup/utils.py", line 93, in set_gpu
    torch.cuda.set_device(args.multigpu[0])
  File "/home/at2507/miniconda3/lib/python3.8/site-packages/torch/cuda/__init__.py", line 245, in set_device
    torch._C._cuda_setDevice(device)
RuntimeError: cuda runtime error (101) : invalid device ordinal at /pytorch/torch/csrc/cuda/Module.cpp:59
THCudaCheck FAIL file=/pytorch/torch/csrc/cuda/Module.cpp line=59 error=101 : invalid device ordinal
=> Reading YAML config from experiments/SupsupSeed/splitcifar100/configs/rn18-supsup_7.yaml
=> Saving data in runs/SupsupSeed/rn18-supsup_gpu2_num_masks_7/id=supsup~seed=0~sparsity=2~try=2
Files already downloaded and verified
Files already downloaded and verified
[26 86  2 55 75 93 16 73 54 95 53 92 78 13  7 30 22 24 33  8 43 62  3 71
 45 48  6 99 82 76 60 80 90 68 51 27 18 56 63 74  1 61 42 41  4 15 17 40
 38  5 91 59  0 34 28 50 11 35 23 52 10 31 66 57 79 85 32 84 14 89 19 29
 49 97 98 69 20 94 72 77 25 37 81 46 39 65 58 12 88 70 87 36 21 83  9 96
 67 64 47 44]
[26 86  2 55 75]
[93 16 73 54 95]
[53 92 78 13  7]
[30 22 24 33  8]
[43 62  3 71 45]
[48  6 99 82 76]
[60 80 90 68 51]
Set sparsity of conv1 to 0.08518518518518518
Set sparsity of layer1.0.conv1 to 0.022222222222222223
Set sparsity of layer1.0.conv2 to 0.022222222222222223
Set sparsity of layer1.1.conv1 to 0.022222222222222223
Set sparsity of layer1.1.conv2 to 0.022222222222222223
Set sparsity of layer2.0.conv1 to 0.016666666666666666
Set sparsity of layer2.0.conv2 to 0.011111111111111112
Set sparsity of layer2.0.shortcut.0 to 0.15
Set sparsity of layer2.1.conv1 to 0.011111111111111112
Set sparsity of layer2.1.conv2 to 0.011111111111111112
Set sparsity of layer3.0.conv1 to 0.008333333333333333
Set sparsity of layer3.0.conv2 to 0.005555555555555556
Set sparsity of layer3.0.shortcut.0 to 0.075
Set sparsity of layer3.1.conv1 to 0.005555555555555556
Set sparsity of layer3.1.conv2 to 0.005555555555555556
Set sparsity of layer4.0.conv1 to 0.004166666666666667
Set sparsity of layer4.0.conv2 to 0.002777777777777778
Set sparsity of layer4.0.shortcut.0 to 0.0375
Set sparsity of layer4.1.conv1 to 0.002777777777777778
Set sparsity of layer4.1.conv2 to 0.002777777777777778
Set sparsity of linear to 0.4125
=> Parallelizing on [2] gpus
Traceback (most recent call last):
  File "main.py", line 425, in <module>
    main()
  File "main.py", line 81, in main
    model = utils.set_gpu(model)
  File "/home/at2507/supsup_team/supsup/utils.py", line 93, in set_gpu
    torch.cuda.set_device(args.multigpu[0])
  File "/home/at2507/miniconda3/lib/python3.8/site-packages/torch/cuda/__init__.py", line 245, in set_device
    torch._C._cuda_setDevice(device)
RuntimeError: cuda runtime error (101) : invalid device ordinal at /pytorch/torch/csrc/cuda/Module.cpp:59
THCudaCheck FAIL file=/pytorch/torch/csrc/cuda/Module.cpp line=59 error=101 : invalid device ordinal
=> Reading YAML config from experiments/SupsupSeed/splitcifar100/configs/rn18-supsup_7.yaml
=> Saving data in runs/SupsupSeed/rn18-supsup_gpu2_num_masks_7/id=supsup~seed=0~sparsity=4~try=2
Files already downloaded and verified
Files already downloaded and verified
[26 86  2 55 75 93 16 73 54 95 53 92 78 13  7 30 22 24 33  8 43 62  3 71
 45 48  6 99 82 76 60 80 90 68 51 27 18 56 63 74  1 61 42 41  4 15 17 40
 38  5 91 59  0 34 28 50 11 35 23 52 10 31 66 57 79 85 32 84 14 89 19 29
 49 97 98 69 20 94 72 77 25 37 81 46 39 65 58 12 88 70 87 36 21 83  9 96
 67 64 47 44]
[26 86  2 55 75]
[93 16 73 54 95]
[53 92 78 13  7]
[30 22 24 33  8]
[43 62  3 71 45]
[48  6 99 82 76]
[60 80 90 68 51]
Set sparsity of conv1 to 0.17037037037037037
Set sparsity of layer1.0.conv1 to 0.044444444444444446
Set sparsity of layer1.0.conv2 to 0.044444444444444446
Set sparsity of layer1.1.conv1 to 0.044444444444444446
Set sparsity of layer1.1.conv2 to 0.044444444444444446
Set sparsity of layer2.0.conv1 to 0.03333333333333333
Set sparsity of layer2.0.conv2 to 0.022222222222222223
Set sparsity of layer2.0.shortcut.0 to 0.3
Set sparsity of layer2.1.conv1 to 0.022222222222222223
Set sparsity of layer2.1.conv2 to 0.022222222222222223
Set sparsity of layer3.0.conv1 to 0.016666666666666666
Set sparsity of layer3.0.conv2 to 0.011111111111111112
Set sparsity of layer3.0.shortcut.0 to 0.15
Set sparsity of layer3.1.conv1 to 0.011111111111111112
Set sparsity of layer3.1.conv2 to 0.011111111111111112
Set sparsity of layer4.0.conv1 to 0.008333333333333333
Set sparsity of layer4.0.conv2 to 0.005555555555555556
Set sparsity of layer4.0.shortcut.0 to 0.075
Set sparsity of layer4.1.conv1 to 0.005555555555555556
Set sparsity of layer4.1.conv2 to 0.005555555555555556
Set sparsity of linear to 0.5
=> Parallelizing on [2] gpus
Traceback (most recent call last):
  File "main.py", line 425, in <module>
    main()
  File "main.py", line 81, in main
    model = utils.set_gpu(model)
  File "/home/at2507/supsup_team/supsup/utils.py", line 93, in set_gpu
    torch.cuda.set_device(args.multigpu[0])
  File "/home/at2507/miniconda3/lib/python3.8/site-packages/torch/cuda/__init__.py", line 245, in set_device
    torch._C._cuda_setDevice(device)
RuntimeError: cuda runtime error (101) : invalid device ordinal at /pytorch/torch/csrc/cuda/Module.cpp:59
THCudaCheck FAIL file=/pytorch/torch/csrc/cuda/Module.cpp line=59 error=101 : invalid device ordinal
=> Reading YAML config from experiments/SupsupSeed/splitcifar100/configs/rn18-supsup_7.yaml
=> Saving data in runs/SupsupSeed/rn18-supsup_gpu2_num_masks_7/id=supsup~seed=0~sparsity=8~try=2
Files already downloaded and verified
Files already downloaded and verified
[26 86  2 55 75 93 16 73 54 95 53 92 78 13  7 30 22 24 33  8 43 62  3 71
 45 48  6 99 82 76 60 80 90 68 51 27 18 56 63 74  1 61 42 41  4 15 17 40
 38  5 91 59  0 34 28 50 11 35 23 52 10 31 66 57 79 85 32 84 14 89 19 29
 49 97 98 69 20 94 72 77 25 37 81 46 39 65 58 12 88 70 87 36 21 83  9 96
 67 64 47 44]
[26 86  2 55 75]
[93 16 73 54 95]
[53 92 78 13  7]
[30 22 24 33  8]
[43 62  3 71 45]
[48  6 99 82 76]
[60 80 90 68 51]
Set sparsity of conv1 to 0.34074074074074073
Set sparsity of layer1.0.conv1 to 0.08888888888888889
Set sparsity of layer1.0.conv2 to 0.08888888888888889
Set sparsity of layer1.1.conv1 to 0.08888888888888889
Set sparsity of layer1.1.conv2 to 0.08888888888888889
Set sparsity of layer2.0.conv1 to 0.06666666666666667
Set sparsity of layer2.0.conv2 to 0.044444444444444446
Set sparsity of layer2.0.shortcut.0 to 0.5
Set sparsity of layer2.1.conv1 to 0.044444444444444446
Set sparsity of layer2.1.conv2 to 0.044444444444444446
Set sparsity of layer3.0.conv1 to 0.03333333333333333
Set sparsity of layer3.0.conv2 to 0.022222222222222223
Set sparsity of layer3.0.shortcut.0 to 0.3
Set sparsity of layer3.1.conv1 to 0.022222222222222223
Set sparsity of layer3.1.conv2 to 0.022222222222222223
Set sparsity of layer4.0.conv1 to 0.016666666666666666
Set sparsity of layer4.0.conv2 to 0.011111111111111112
Set sparsity of layer4.0.shortcut.0 to 0.15
Set sparsity of layer4.1.conv1 to 0.011111111111111112
Set sparsity of layer4.1.conv2 to 0.011111111111111112
Set sparsity of linear to 0.5
=> Parallelizing on [2] gpus
Traceback (most recent call last):
  File "main.py", line 425, in <module>
    main()
  File "main.py", line 81, in main
    model = utils.set_gpu(model)
  File "/home/at2507/supsup_team/supsup/utils.py", line 93, in set_gpu
    torch.cuda.set_device(args.multigpu[0])
  File "/home/at2507/miniconda3/lib/python3.8/site-packages/torch/cuda/__init__.py", line 245, in set_device
    torch._C._cuda_setDevice(device)
RuntimeError: cuda runtime error (101) : invalid device ordinal at /pytorch/torch/csrc/cuda/Module.cpp:59
THCudaCheck FAIL file=/pytorch/torch/csrc/cuda/Module.cpp line=59 error=101 : invalid device ordinal
=> Reading YAML config from experiments/SupsupSeed/splitcifar100/configs/rn18-supsup_7.yaml
=> Saving data in runs/SupsupSeed/rn18-supsup_gpu2_num_masks_7/id=supsup~seed=0~sparsity=16~try=2
Files already downloaded and verified
Files already downloaded and verified
[26 86  2 55 75 93 16 73 54 95 53 92 78 13  7 30 22 24 33  8 43 62  3 71
 45 48  6 99 82 76 60 80 90 68 51 27 18 56 63 74  1 61 42 41  4 15 17 40
 38  5 91 59  0 34 28 50 11 35 23 52 10 31 66 57 79 85 32 84 14 89 19 29
 49 97 98 69 20 94 72 77 25 37 81 46 39 65 58 12 88 70 87 36 21 83  9 96
 67 64 47 44]
[26 86  2 55 75]
[93 16 73 54 95]
[53 92 78 13  7]
[30 22 24 33  8]
[43 62  3 71 45]
[48  6 99 82 76]
[60 80 90 68 51]
Set sparsity of conv1 to 0.5
Set sparsity of layer1.0.conv1 to 0.17777777777777778
Set sparsity of layer1.0.conv2 to 0.17777777777777778
Set sparsity of layer1.1.conv1 to 0.17777777777777778
Set sparsity of layer1.1.conv2 to 0.17777777777777778
Set sparsity of layer2.0.conv1 to 0.13333333333333333
Set sparsity of layer2.0.conv2 to 0.08888888888888889
Set sparsity of layer2.0.shortcut.0 to 0.5
Set sparsity of layer2.1.conv1 to 0.08888888888888889
Set sparsity of layer2.1.conv2 to 0.08888888888888889
Set sparsity of layer3.0.conv1 to 0.06666666666666667
Set sparsity of layer3.0.conv2 to 0.044444444444444446
Set sparsity of layer3.0.shortcut.0 to 0.5
Set sparsity of layer3.1.conv1 to 0.044444444444444446
Set sparsity of layer3.1.conv2 to 0.044444444444444446
Set sparsity of layer4.0.conv1 to 0.03333333333333333
Set sparsity of layer4.0.conv2 to 0.022222222222222223
Set sparsity of layer4.0.shortcut.0 to 0.3
Set sparsity of layer4.1.conv1 to 0.022222222222222223
Set sparsity of layer4.1.conv2 to 0.022222222222222223
Set sparsity of linear to 0.5
=> Parallelizing on [2] gpus
Traceback (most recent call last):
  File "main.py", line 425, in <module>
    main()
  File "main.py", line 81, in main
    model = utils.set_gpu(model)
  File "/home/at2507/supsup_team/supsup/utils.py", line 93, in set_gpu
    torch.cuda.set_device(args.multigpu[0])
  File "/home/at2507/miniconda3/lib/python3.8/site-packages/torch/cuda/__init__.py", line 245, in set_device
    torch._C._cuda_setDevice(device)
RuntimeError: cuda runtime error (101) : invalid device ordinal at /pytorch/torch/csrc/cuda/Module.cpp:59
THCudaCheck FAIL file=/pytorch/torch/csrc/cuda/Module.cpp line=59 error=101 : invalid device ordinal
=> Reading YAML config from experiments/SupsupSeed/splitcifar100/configs/rn18-supsup_7.yaml
=> Saving data in runs/SupsupSeed/rn18-supsup_gpu2_num_masks_7/id=supsup~seed=0~sparsity=32~try=2
Files already downloaded and verified
Files already downloaded and verified
[26 86  2 55 75 93 16 73 54 95 53 92 78 13  7 30 22 24 33  8 43 62  3 71
 45 48  6 99 82 76 60 80 90 68 51 27 18 56 63 74  1 61 42 41  4 15 17 40
 38  5 91 59  0 34 28 50 11 35 23 52 10 31 66 57 79 85 32 84 14 89 19 29
 49 97 98 69 20 94 72 77 25 37 81 46 39 65 58 12 88 70 87 36 21 83  9 96
 67 64 47 44]
[26 86  2 55 75]
[93 16 73 54 95]
[53 92 78 13  7]
[30 22 24 33  8]
[43 62  3 71 45]
[48  6 99 82 76]
[60 80 90 68 51]
Set sparsity of conv1 to 0.5
Set sparsity of layer1.0.conv1 to 0.35555555555555557
Set sparsity of layer1.0.conv2 to 0.35555555555555557
Set sparsity of layer1.1.conv1 to 0.35555555555555557
Set sparsity of layer1.1.conv2 to 0.35555555555555557
Set sparsity of layer2.0.conv1 to 0.26666666666666666
Set sparsity of layer2.0.conv2 to 0.17777777777777778
Set sparsity of layer2.0.shortcut.0 to 0.5
Set sparsity of layer2.1.conv1 to 0.17777777777777778
Set sparsity of layer2.1.conv2 to 0.17777777777777778
Set sparsity of layer3.0.conv1 to 0.13333333333333333
Set sparsity of layer3.0.conv2 to 0.08888888888888889
Set sparsity of layer3.0.shortcut.0 to 0.5
Set sparsity of layer3.1.conv1 to 0.08888888888888889
Set sparsity of layer3.1.conv2 to 0.08888888888888889
Set sparsity of layer4.0.conv1 to 0.06666666666666667
Set sparsity of layer4.0.conv2 to 0.044444444444444446
Set sparsity of layer4.0.shortcut.0 to 0.5
Set sparsity of layer4.1.conv1 to 0.044444444444444446
Set sparsity of layer4.1.conv2 to 0.044444444444444446
Set sparsity of linear to 0.5
=> Parallelizing on [2] gpus
Traceback (most recent call last):
  File "main.py", line 425, in <module>
    main()
  File "main.py", line 81, in main
    model = utils.set_gpu(model)
  File "/home/at2507/supsup_team/supsup/utils.py", line 93, in set_gpu
    torch.cuda.set_device(args.multigpu[0])
  File "/home/at2507/miniconda3/lib/python3.8/site-packages/torch/cuda/__init__.py", line 245, in set_device
    torch._C._cuda_setDevice(device)
RuntimeError: cuda runtime error (101) : invalid device ordinal at /pytorch/torch/csrc/cuda/Module.cpp:59
==> Starting experiment python main.py --config=experiments/SupsupSeed/splitcifar100/configs/rn18-supsup_7.yaml --name=id=supsup~seed=0~sparsity=1 --sparsity=1 --seed=0 --log-dir=runs/SupsupSeed/rn18-supsup_gpu2_num_masks_7 --epochs=250 --data=./data --multigpu=2 
==> Starting experiment python main.py --config=experiments/SupsupSeed/splitcifar100/configs/rn18-supsup_7.yaml --name=id=supsup~seed=0~sparsity=2 --sparsity=2 --seed=0 --log-dir=runs/SupsupSeed/rn18-supsup_gpu2_num_masks_7 --epochs=250 --data=./data --multigpu=2 
==> Starting experiment python main.py --config=experiments/SupsupSeed/splitcifar100/configs/rn18-supsup_7.yaml --name=id=supsup~seed=0~sparsity=4 --sparsity=4 --seed=0 --log-dir=runs/SupsupSeed/rn18-supsup_gpu2_num_masks_7 --epochs=250 --data=./data --multigpu=2 
==> Starting experiment python main.py --config=experiments/SupsupSeed/splitcifar100/configs/rn18-supsup_7.yaml --name=id=supsup~seed=0~sparsity=8 --sparsity=8 --seed=0 --log-dir=runs/SupsupSeed/rn18-supsup_gpu2_num_masks_7 --epochs=250 --data=./data --multigpu=2 
==> Starting experiment python main.py --config=experiments/SupsupSeed/splitcifar100/configs/rn18-supsup_7.yaml --name=id=supsup~seed=0~sparsity=16 --sparsity=16 --seed=0 --log-dir=runs/SupsupSeed/rn18-supsup_gpu2_num_masks_7 --epochs=250 --data=./data --multigpu=2 
==> Starting experiment python main.py --config=experiments/SupsupSeed/splitcifar100/configs/rn18-supsup_7.yaml --name=id=supsup~seed=0~sparsity=32 --sparsity=32 --seed=0 --log-dir=runs/SupsupSeed/rn18-supsup_gpu2_num_masks_7 --epochs=250 --data=./data --multigpu=2 
[{'config': 'experiments/SupsupSeed/splitcifar100/configs/rn18-supsup_10.yaml', 'name': 'id=supsup~seed=0~sparsity=1', 'sparsity': 1, 'seed': 0, 'log-dir': 'runs/SupsupSeed/rn18-supsup_gpu2_num_masks_10', 'epochs': 250, 'data': './data'}, {'config': 'experiments/SupsupSeed/splitcifar100/configs/rn18-supsup_10.yaml', 'name': 'id=supsup~seed=0~sparsity=2', 'sparsity': 2, 'seed': 0, 'log-dir': 'runs/SupsupSeed/rn18-supsup_gpu2_num_masks_10', 'epochs': 250, 'data': './data'}, {'config': 'experiments/SupsupSeed/splitcifar100/configs/rn18-supsup_10.yaml', 'name': 'id=supsup~seed=0~sparsity=4', 'sparsity': 4, 'seed': 0, 'log-dir': 'runs/SupsupSeed/rn18-supsup_gpu2_num_masks_10', 'epochs': 250, 'data': './data'}, {'config': 'experiments/SupsupSeed/splitcifar100/configs/rn18-supsup_10.yaml', 'name': 'id=supsup~seed=0~sparsity=8', 'sparsity': 8, 'seed': 0, 'log-dir': 'runs/SupsupSeed/rn18-supsup_gpu2_num_masks_10', 'epochs': 250, 'data': './data'}, {'config': 'experiments/SupsupSeed/splitcifar100/configs/rn18-supsup_10.yaml', 'name': 'id=supsup~seed=0~sparsity=16', 'sparsity': 16, 'seed': 0, 'log-dir': 'runs/SupsupSeed/rn18-supsup_gpu2_num_masks_10', 'epochs': 250, 'data': './data'}, {'config': 'experiments/SupsupSeed/splitcifar100/configs/rn18-supsup_10.yaml', 'name': 'id=supsup~seed=0~sparsity=32', 'sparsity': 32, 'seed': 0, 'log-dir': 'runs/SupsupSeed/rn18-supsup_gpu2_num_masks_10', 'epochs': 250, 'data': './data'}]
THCudaCheck FAIL file=/pytorch/torch/csrc/cuda/Module.cpp line=59 error=101 : invalid device ordinal
=> Reading YAML config from experiments/SupsupSeed/splitcifar100/configs/rn18-supsup_10.yaml
=> Saving data in runs/SupsupSeed/rn18-supsup_gpu2_num_masks_10/id=supsup~seed=0~sparsity=1~try=2
Files already downloaded and verified
Files already downloaded and verified
[26 86  2 55 75 93 16 73 54 95 53 92 78 13  7 30 22 24 33  8 43 62  3 71
 45 48  6 99 82 76 60 80 90 68 51 27 18 56 63 74  1 61 42 41  4 15 17 40
 38  5 91 59  0 34 28 50 11 35 23 52 10 31 66 57 79 85 32 84 14 89 19 29
 49 97 98 69 20 94 72 77 25 37 81 46 39 65 58 12 88 70 87 36 21 83  9 96
 67 64 47 44]
[26 86  2 55 75]
[93 16 73 54 95]
[53 92 78 13  7]
[30 22 24 33  8]
[43 62  3 71 45]
[48  6 99 82 76]
[60 80 90 68 51]
[27 18 56 63 74]
[ 1 61 42 41  4]
[15 17 40 38  5]
Set sparsity of conv1 to 0.04259259259259259
Set sparsity of layer1.0.conv1 to 0.011111111111111112
Set sparsity of layer1.0.conv2 to 0.011111111111111112
Set sparsity of layer1.1.conv1 to 0.011111111111111112
Set sparsity of layer1.1.conv2 to 0.011111111111111112
Set sparsity of layer2.0.conv1 to 0.008333333333333333
Set sparsity of layer2.0.conv2 to 0.005555555555555556
Set sparsity of layer2.0.shortcut.0 to 0.075
Set sparsity of layer2.1.conv1 to 0.005555555555555556
Set sparsity of layer2.1.conv2 to 0.005555555555555556
Set sparsity of layer3.0.conv1 to 0.004166666666666667
Set sparsity of layer3.0.conv2 to 0.002777777777777778
Set sparsity of layer3.0.shortcut.0 to 0.0375
Set sparsity of layer3.1.conv1 to 0.002777777777777778
Set sparsity of layer3.1.conv2 to 0.002777777777777778
Set sparsity of layer4.0.conv1 to 0.0020833333333333333
Set sparsity of layer4.0.conv2 to 0.001388888888888889
Set sparsity of layer4.0.shortcut.0 to 0.01875
Set sparsity of layer4.1.conv1 to 0.001388888888888889
Set sparsity of layer4.1.conv2 to 0.001388888888888889
Set sparsity of linear to 0.20625
=> Parallelizing on [2] gpus
Traceback (most recent call last):
  File "main.py", line 425, in <module>
    main()
  File "main.py", line 81, in main
    model = utils.set_gpu(model)
  File "/home/at2507/supsup_team/supsup/utils.py", line 93, in set_gpu
    torch.cuda.set_device(args.multigpu[0])
  File "/home/at2507/miniconda3/lib/python3.8/site-packages/torch/cuda/__init__.py", line 245, in set_device
    torch._C._cuda_setDevice(device)
RuntimeError: cuda runtime error (101) : invalid device ordinal at /pytorch/torch/csrc/cuda/Module.cpp:59
THCudaCheck FAIL file=/pytorch/torch/csrc/cuda/Module.cpp line=59 error=101 : invalid device ordinal
=> Reading YAML config from experiments/SupsupSeed/splitcifar100/configs/rn18-supsup_10.yaml
=> Saving data in runs/SupsupSeed/rn18-supsup_gpu2_num_masks_10/id=supsup~seed=0~sparsity=2~try=2
Files already downloaded and verified
Files already downloaded and verified
[26 86  2 55 75 93 16 73 54 95 53 92 78 13  7 30 22 24 33  8 43 62  3 71
 45 48  6 99 82 76 60 80 90 68 51 27 18 56 63 74  1 61 42 41  4 15 17 40
 38  5 91 59  0 34 28 50 11 35 23 52 10 31 66 57 79 85 32 84 14 89 19 29
 49 97 98 69 20 94 72 77 25 37 81 46 39 65 58 12 88 70 87 36 21 83  9 96
 67 64 47 44]
[26 86  2 55 75]
[93 16 73 54 95]
[53 92 78 13  7]
[30 22 24 33  8]
[43 62  3 71 45]
[48  6 99 82 76]
[60 80 90 68 51]
[27 18 56 63 74]
[ 1 61 42 41  4]
[15 17 40 38  5]
Set sparsity of conv1 to 0.08518518518518518
Set sparsity of layer1.0.conv1 to 0.022222222222222223
Set sparsity of layer1.0.conv2 to 0.022222222222222223
Set sparsity of layer1.1.conv1 to 0.022222222222222223
Set sparsity of layer1.1.conv2 to 0.022222222222222223
Set sparsity of layer2.0.conv1 to 0.016666666666666666
Set sparsity of layer2.0.conv2 to 0.011111111111111112
Set sparsity of layer2.0.shortcut.0 to 0.15
Set sparsity of layer2.1.conv1 to 0.011111111111111112
Set sparsity of layer2.1.conv2 to 0.011111111111111112
Set sparsity of layer3.0.conv1 to 0.008333333333333333
Set sparsity of layer3.0.conv2 to 0.005555555555555556
Set sparsity of layer3.0.shortcut.0 to 0.075
Set sparsity of layer3.1.conv1 to 0.005555555555555556
Set sparsity of layer3.1.conv2 to 0.005555555555555556
Set sparsity of layer4.0.conv1 to 0.004166666666666667
Set sparsity of layer4.0.conv2 to 0.002777777777777778
Set sparsity of layer4.0.shortcut.0 to 0.0375
Set sparsity of layer4.1.conv1 to 0.002777777777777778
Set sparsity of layer4.1.conv2 to 0.002777777777777778
Set sparsity of linear to 0.4125
=> Parallelizing on [2] gpus
Traceback (most recent call last):
  File "main.py", line 425, in <module>
    main()
  File "main.py", line 81, in main
    model = utils.set_gpu(model)
  File "/home/at2507/supsup_team/supsup/utils.py", line 93, in set_gpu
    torch.cuda.set_device(args.multigpu[0])
  File "/home/at2507/miniconda3/lib/python3.8/site-packages/torch/cuda/__init__.py", line 245, in set_device
    torch._C._cuda_setDevice(device)
RuntimeError: cuda runtime error (101) : invalid device ordinal at /pytorch/torch/csrc/cuda/Module.cpp:59
THCudaCheck FAIL file=/pytorch/torch/csrc/cuda/Module.cpp line=59 error=101 : invalid device ordinal
=> Reading YAML config from experiments/SupsupSeed/splitcifar100/configs/rn18-supsup_10.yaml
=> Saving data in runs/SupsupSeed/rn18-supsup_gpu2_num_masks_10/id=supsup~seed=0~sparsity=4~try=2
Files already downloaded and verified
Files already downloaded and verified
[26 86  2 55 75 93 16 73 54 95 53 92 78 13  7 30 22 24 33  8 43 62  3 71
 45 48  6 99 82 76 60 80 90 68 51 27 18 56 63 74  1 61 42 41  4 15 17 40
 38  5 91 59  0 34 28 50 11 35 23 52 10 31 66 57 79 85 32 84 14 89 19 29
 49 97 98 69 20 94 72 77 25 37 81 46 39 65 58 12 88 70 87 36 21 83  9 96
 67 64 47 44]
[26 86  2 55 75]
[93 16 73 54 95]
[53 92 78 13  7]
[30 22 24 33  8]
[43 62  3 71 45]
[48  6 99 82 76]
[60 80 90 68 51]
[27 18 56 63 74]
[ 1 61 42 41  4]
[15 17 40 38  5]
Set sparsity of conv1 to 0.17037037037037037
Set sparsity of layer1.0.conv1 to 0.044444444444444446
Set sparsity of layer1.0.conv2 to 0.044444444444444446
Set sparsity of layer1.1.conv1 to 0.044444444444444446
Set sparsity of layer1.1.conv2 to 0.044444444444444446
Set sparsity of layer2.0.conv1 to 0.03333333333333333
Set sparsity of layer2.0.conv2 to 0.022222222222222223
Set sparsity of layer2.0.shortcut.0 to 0.3
Set sparsity of layer2.1.conv1 to 0.022222222222222223
Set sparsity of layer2.1.conv2 to 0.022222222222222223
Set sparsity of layer3.0.conv1 to 0.016666666666666666
Set sparsity of layer3.0.conv2 to 0.011111111111111112
Set sparsity of layer3.0.shortcut.0 to 0.15
Set sparsity of layer3.1.conv1 to 0.011111111111111112
Set sparsity of layer3.1.conv2 to 0.011111111111111112
Set sparsity of layer4.0.conv1 to 0.008333333333333333
Set sparsity of layer4.0.conv2 to 0.005555555555555556
Set sparsity of layer4.0.shortcut.0 to 0.075
Set sparsity of layer4.1.conv1 to 0.005555555555555556
Set sparsity of layer4.1.conv2 to 0.005555555555555556
Set sparsity of linear to 0.5
=> Parallelizing on [2] gpus
Traceback (most recent call last):
  File "main.py", line 425, in <module>
    main()
  File "main.py", line 81, in main
    model = utils.set_gpu(model)
  File "/home/at2507/supsup_team/supsup/utils.py", line 93, in set_gpu
    torch.cuda.set_device(args.multigpu[0])
  File "/home/at2507/miniconda3/lib/python3.8/site-packages/torch/cuda/__init__.py", line 245, in set_device
    torch._C._cuda_setDevice(device)
RuntimeError: cuda runtime error (101) : invalid device ordinal at /pytorch/torch/csrc/cuda/Module.cpp:59
THCudaCheck FAIL file=/pytorch/torch/csrc/cuda/Module.cpp line=59 error=101 : invalid device ordinal
=> Reading YAML config from experiments/SupsupSeed/splitcifar100/configs/rn18-supsup_10.yaml
=> Saving data in runs/SupsupSeed/rn18-supsup_gpu2_num_masks_10/id=supsup~seed=0~sparsity=8~try=2
Files already downloaded and verified
Files already downloaded and verified
[26 86  2 55 75 93 16 73 54 95 53 92 78 13  7 30 22 24 33  8 43 62  3 71
 45 48  6 99 82 76 60 80 90 68 51 27 18 56 63 74  1 61 42 41  4 15 17 40
 38  5 91 59  0 34 28 50 11 35 23 52 10 31 66 57 79 85 32 84 14 89 19 29
 49 97 98 69 20 94 72 77 25 37 81 46 39 65 58 12 88 70 87 36 21 83  9 96
 67 64 47 44]
[26 86  2 55 75]
[93 16 73 54 95]
[53 92 78 13  7]
[30 22 24 33  8]
[43 62  3 71 45]
[48  6 99 82 76]
[60 80 90 68 51]
[27 18 56 63 74]
[ 1 61 42 41  4]
[15 17 40 38  5]
Set sparsity of conv1 to 0.34074074074074073
Set sparsity of layer1.0.conv1 to 0.08888888888888889
Set sparsity of layer1.0.conv2 to 0.08888888888888889
Set sparsity of layer1.1.conv1 to 0.08888888888888889
Set sparsity of layer1.1.conv2 to 0.08888888888888889
Set sparsity of layer2.0.conv1 to 0.06666666666666667
Set sparsity of layer2.0.conv2 to 0.044444444444444446
Set sparsity of layer2.0.shortcut.0 to 0.5
Set sparsity of layer2.1.conv1 to 0.044444444444444446
Set sparsity of layer2.1.conv2 to 0.044444444444444446
Set sparsity of layer3.0.conv1 to 0.03333333333333333
Set sparsity of layer3.0.conv2 to 0.022222222222222223
Set sparsity of layer3.0.shortcut.0 to 0.3
Set sparsity of layer3.1.conv1 to 0.022222222222222223
Set sparsity of layer3.1.conv2 to 0.022222222222222223
Set sparsity of layer4.0.conv1 to 0.016666666666666666
Set sparsity of layer4.0.conv2 to 0.011111111111111112
Set sparsity of layer4.0.shortcut.0 to 0.15
Set sparsity of layer4.1.conv1 to 0.011111111111111112
Set sparsity of layer4.1.conv2 to 0.011111111111111112
Set sparsity of linear to 0.5
=> Parallelizing on [2] gpus
Traceback (most recent call last):
  File "main.py", line 425, in <module>
    main()
  File "main.py", line 81, in main
    model = utils.set_gpu(model)
  File "/home/at2507/supsup_team/supsup/utils.py", line 93, in set_gpu
    torch.cuda.set_device(args.multigpu[0])
  File "/home/at2507/miniconda3/lib/python3.8/site-packages/torch/cuda/__init__.py", line 245, in set_device
    torch._C._cuda_setDevice(device)
RuntimeError: cuda runtime error (101) : invalid device ordinal at /pytorch/torch/csrc/cuda/Module.cpp:59
THCudaCheck FAIL file=/pytorch/torch/csrc/cuda/Module.cpp line=59 error=101 : invalid device ordinal
=> Reading YAML config from experiments/SupsupSeed/splitcifar100/configs/rn18-supsup_10.yaml
=> Saving data in runs/SupsupSeed/rn18-supsup_gpu2_num_masks_10/id=supsup~seed=0~sparsity=16~try=2
Files already downloaded and verified
Files already downloaded and verified
[26 86  2 55 75 93 16 73 54 95 53 92 78 13  7 30 22 24 33  8 43 62  3 71
 45 48  6 99 82 76 60 80 90 68 51 27 18 56 63 74  1 61 42 41  4 15 17 40
 38  5 91 59  0 34 28 50 11 35 23 52 10 31 66 57 79 85 32 84 14 89 19 29
 49 97 98 69 20 94 72 77 25 37 81 46 39 65 58 12 88 70 87 36 21 83  9 96
 67 64 47 44]
[26 86  2 55 75]
[93 16 73 54 95]
[53 92 78 13  7]
[30 22 24 33  8]
[43 62  3 71 45]
[48  6 99 82 76]
[60 80 90 68 51]
[27 18 56 63 74]
[ 1 61 42 41  4]
[15 17 40 38  5]
Set sparsity of conv1 to 0.5
Set sparsity of layer1.0.conv1 to 0.17777777777777778
Set sparsity of layer1.0.conv2 to 0.17777777777777778
Set sparsity of layer1.1.conv1 to 0.17777777777777778
Set sparsity of layer1.1.conv2 to 0.17777777777777778
Set sparsity of layer2.0.conv1 to 0.13333333333333333
Set sparsity of layer2.0.conv2 to 0.08888888888888889
Set sparsity of layer2.0.shortcut.0 to 0.5
Set sparsity of layer2.1.conv1 to 0.08888888888888889
Set sparsity of layer2.1.conv2 to 0.08888888888888889
Set sparsity of layer3.0.conv1 to 0.06666666666666667
Set sparsity of layer3.0.conv2 to 0.044444444444444446
Set sparsity of layer3.0.shortcut.0 to 0.5
Set sparsity of layer3.1.conv1 to 0.044444444444444446
Set sparsity of layer3.1.conv2 to 0.044444444444444446
Set sparsity of layer4.0.conv1 to 0.03333333333333333
Set sparsity of layer4.0.conv2 to 0.022222222222222223
Set sparsity of layer4.0.shortcut.0 to 0.3
Set sparsity of layer4.1.conv1 to 0.022222222222222223
Set sparsity of layer4.1.conv2 to 0.022222222222222223
Set sparsity of linear to 0.5
=> Parallelizing on [2] gpus
Traceback (most recent call last):
  File "main.py", line 425, in <module>
    main()
  File "main.py", line 81, in main
    model = utils.set_gpu(model)
  File "/home/at2507/supsup_team/supsup/utils.py", line 93, in set_gpu
    torch.cuda.set_device(args.multigpu[0])
  File "/home/at2507/miniconda3/lib/python3.8/site-packages/torch/cuda/__init__.py", line 245, in set_device
    torch._C._cuda_setDevice(device)
RuntimeError: cuda runtime error (101) : invalid device ordinal at /pytorch/torch/csrc/cuda/Module.cpp:59
THCudaCheck FAIL file=/pytorch/torch/csrc/cuda/Module.cpp line=59 error=101 : invalid device ordinal
=> Reading YAML config from experiments/SupsupSeed/splitcifar100/configs/rn18-supsup_10.yaml
=> Saving data in runs/SupsupSeed/rn18-supsup_gpu2_num_masks_10/id=supsup~seed=0~sparsity=32~try=2
Files already downloaded and verified
Files already downloaded and verified
[26 86  2 55 75 93 16 73 54 95 53 92 78 13  7 30 22 24 33  8 43 62  3 71
 45 48  6 99 82 76 60 80 90 68 51 27 18 56 63 74  1 61 42 41  4 15 17 40
 38  5 91 59  0 34 28 50 11 35 23 52 10 31 66 57 79 85 32 84 14 89 19 29
 49 97 98 69 20 94 72 77 25 37 81 46 39 65 58 12 88 70 87 36 21 83  9 96
 67 64 47 44]
[26 86  2 55 75]
[93 16 73 54 95]
[53 92 78 13  7]
[30 22 24 33  8]
[43 62  3 71 45]
[48  6 99 82 76]
[60 80 90 68 51]
[27 18 56 63 74]
[ 1 61 42 41  4]
[15 17 40 38  5]
Set sparsity of conv1 to 0.5
Set sparsity of layer1.0.conv1 to 0.35555555555555557
Set sparsity of layer1.0.conv2 to 0.35555555555555557
Set sparsity of layer1.1.conv1 to 0.35555555555555557
Set sparsity of layer1.1.conv2 to 0.35555555555555557
Set sparsity of layer2.0.conv1 to 0.26666666666666666
Set sparsity of layer2.0.conv2 to 0.17777777777777778
Set sparsity of layer2.0.shortcut.0 to 0.5
Set sparsity of layer2.1.conv1 to 0.17777777777777778
Set sparsity of layer2.1.conv2 to 0.17777777777777778
Set sparsity of layer3.0.conv1 to 0.13333333333333333
Set sparsity of layer3.0.conv2 to 0.08888888888888889
Set sparsity of layer3.0.shortcut.0 to 0.5
Set sparsity of layer3.1.conv1 to 0.08888888888888889
Set sparsity of layer3.1.conv2 to 0.08888888888888889
Set sparsity of layer4.0.conv1 to 0.06666666666666667
Set sparsity of layer4.0.conv2 to 0.044444444444444446
Set sparsity of layer4.0.shortcut.0 to 0.5
Set sparsity of layer4.1.conv1 to 0.044444444444444446
Set sparsity of layer4.1.conv2 to 0.044444444444444446
Set sparsity of linear to 0.5
=> Parallelizing on [2] gpus
Traceback (most recent call last):
  File "main.py", line 425, in <module>
    main()
  File "main.py", line 81, in main
    model = utils.set_gpu(model)
  File "/home/at2507/supsup_team/supsup/utils.py", line 93, in set_gpu
    torch.cuda.set_device(args.multigpu[0])
  File "/home/at2507/miniconda3/lib/python3.8/site-packages/torch/cuda/__init__.py", line 245, in set_device
    torch._C._cuda_setDevice(device)
RuntimeError: cuda runtime error (101) : invalid device ordinal at /pytorch/torch/csrc/cuda/Module.cpp:59
==> Starting experiment python main.py --config=experiments/SupsupSeed/splitcifar100/configs/rn18-supsup_10.yaml --name=id=supsup~seed=0~sparsity=1 --sparsity=1 --seed=0 --log-dir=runs/SupsupSeed/rn18-supsup_gpu2_num_masks_10 --epochs=250 --data=./data --multigpu=2 
==> Starting experiment python main.py --config=experiments/SupsupSeed/splitcifar100/configs/rn18-supsup_10.yaml --name=id=supsup~seed=0~sparsity=2 --sparsity=2 --seed=0 --log-dir=runs/SupsupSeed/rn18-supsup_gpu2_num_masks_10 --epochs=250 --data=./data --multigpu=2 
==> Starting experiment python main.py --config=experiments/SupsupSeed/splitcifar100/configs/rn18-supsup_10.yaml --name=id=supsup~seed=0~sparsity=4 --sparsity=4 --seed=0 --log-dir=runs/SupsupSeed/rn18-supsup_gpu2_num_masks_10 --epochs=250 --data=./data --multigpu=2 
==> Starting experiment python main.py --config=experiments/SupsupSeed/splitcifar100/configs/rn18-supsup_10.yaml --name=id=supsup~seed=0~sparsity=8 --sparsity=8 --seed=0 --log-dir=runs/SupsupSeed/rn18-supsup_gpu2_num_masks_10 --epochs=250 --data=./data --multigpu=2 
==> Starting experiment python main.py --config=experiments/SupsupSeed/splitcifar100/configs/rn18-supsup_10.yaml --name=id=supsup~seed=0~sparsity=16 --sparsity=16 --seed=0 --log-dir=runs/SupsupSeed/rn18-supsup_gpu2_num_masks_10 --epochs=250 --data=./data --multigpu=2 
==> Starting experiment python main.py --config=experiments/SupsupSeed/splitcifar100/configs/rn18-supsup_10.yaml --name=id=supsup~seed=0~sparsity=32 --sparsity=32 --seed=0 --log-dir=runs/SupsupSeed/rn18-supsup_gpu2_num_masks_10 --epochs=250 --data=./data --multigpu=2 
[{'config': 'experiments/SupsupSeed/splitcifar100/configs/rn18-supsup_12.yaml', 'name': 'id=supsup~seed=0~sparsity=1', 'sparsity': 1, 'seed': 0, 'log-dir': 'runs/SupsupSeed/rn18-supsup_gpu2_num_masks_12', 'epochs': 250, 'data': './data'}, {'config': 'experiments/SupsupSeed/splitcifar100/configs/rn18-supsup_12.yaml', 'name': 'id=supsup~seed=0~sparsity=2', 'sparsity': 2, 'seed': 0, 'log-dir': 'runs/SupsupSeed/rn18-supsup_gpu2_num_masks_12', 'epochs': 250, 'data': './data'}, {'config': 'experiments/SupsupSeed/splitcifar100/configs/rn18-supsup_12.yaml', 'name': 'id=supsup~seed=0~sparsity=4', 'sparsity': 4, 'seed': 0, 'log-dir': 'runs/SupsupSeed/rn18-supsup_gpu2_num_masks_12', 'epochs': 250, 'data': './data'}, {'config': 'experiments/SupsupSeed/splitcifar100/configs/rn18-supsup_12.yaml', 'name': 'id=supsup~seed=0~sparsity=8', 'sparsity': 8, 'seed': 0, 'log-dir': 'runs/SupsupSeed/rn18-supsup_gpu2_num_masks_12', 'epochs': 250, 'data': './data'}, {'config': 'experiments/SupsupSeed/splitcifar100/configs/rn18-supsup_12.yaml', 'name': 'id=supsup~seed=0~sparsity=16', 'sparsity': 16, 'seed': 0, 'log-dir': 'runs/SupsupSeed/rn18-supsup_gpu2_num_masks_12', 'epochs': 250, 'data': './data'}, {'config': 'experiments/SupsupSeed/splitcifar100/configs/rn18-supsup_12.yaml', 'name': 'id=supsup~seed=0~sparsity=32', 'sparsity': 32, 'seed': 0, 'log-dir': 'runs/SupsupSeed/rn18-supsup_gpu2_num_masks_12', 'epochs': 250, 'data': './data'}]
THCudaCheck FAIL file=/pytorch/torch/csrc/cuda/Module.cpp line=59 error=101 : invalid device ordinal
=> Reading YAML config from experiments/SupsupSeed/splitcifar100/configs/rn18-supsup_12.yaml
=> Saving data in runs/SupsupSeed/rn18-supsup_gpu2_num_masks_12/id=supsup~seed=0~sparsity=1~try=2
Files already downloaded and verified
Files already downloaded and verified
[26 86  2 55 75 93 16 73 54 95 53 92 78 13  7 30 22 24 33  8 43 62  3 71
 45 48  6 99 82 76 60 80 90 68 51 27 18 56 63 74  1 61 42 41  4 15 17 40
 38  5 91 59  0 34 28 50 11 35 23 52 10 31 66 57 79 85 32 84 14 89 19 29
 49 97 98 69 20 94 72 77 25 37 81 46 39 65 58 12 88 70 87 36 21 83  9 96
 67 64 47 44]
[26 86  2 55 75]
[93 16 73 54 95]
[53 92 78 13  7]
[30 22 24 33  8]
[43 62  3 71 45]
[48  6 99 82 76]
[60 80 90 68 51]
[27 18 56 63 74]
[ 1 61 42 41  4]
[15 17 40 38  5]
[91 59  0 34 28]
[50 11 35 23 52]
Set sparsity of conv1 to 0.04259259259259259
Set sparsity of layer1.0.conv1 to 0.011111111111111112
Set sparsity of layer1.0.conv2 to 0.011111111111111112
Set sparsity of layer1.1.conv1 to 0.011111111111111112
Set sparsity of layer1.1.conv2 to 0.011111111111111112
Set sparsity of layer2.0.conv1 to 0.008333333333333333
Set sparsity of layer2.0.conv2 to 0.005555555555555556
Set sparsity of layer2.0.shortcut.0 to 0.075
Set sparsity of layer2.1.conv1 to 0.005555555555555556
Set sparsity of layer2.1.conv2 to 0.005555555555555556
Set sparsity of layer3.0.conv1 to 0.004166666666666667
Set sparsity of layer3.0.conv2 to 0.002777777777777778
Set sparsity of layer3.0.shortcut.0 to 0.0375
Set sparsity of layer3.1.conv1 to 0.002777777777777778
Set sparsity of layer3.1.conv2 to 0.002777777777777778
Set sparsity of layer4.0.conv1 to 0.0020833333333333333
Set sparsity of layer4.0.conv2 to 0.001388888888888889
Set sparsity of layer4.0.shortcut.0 to 0.01875
Set sparsity of layer4.1.conv1 to 0.001388888888888889
Set sparsity of layer4.1.conv2 to 0.001388888888888889
Set sparsity of linear to 0.20625
=> Parallelizing on [2] gpus
Traceback (most recent call last):
  File "main.py", line 425, in <module>
    main()
  File "main.py", line 81, in main
    model = utils.set_gpu(model)
  File "/home/at2507/supsup_team/supsup/utils.py", line 93, in set_gpu
    torch.cuda.set_device(args.multigpu[0])
  File "/home/at2507/miniconda3/lib/python3.8/site-packages/torch/cuda/__init__.py", line 245, in set_device
    torch._C._cuda_setDevice(device)
RuntimeError: cuda runtime error (101) : invalid device ordinal at /pytorch/torch/csrc/cuda/Module.cpp:59
THCudaCheck FAIL file=/pytorch/torch/csrc/cuda/Module.cpp line=59 error=101 : invalid device ordinal
=> Reading YAML config from experiments/SupsupSeed/splitcifar100/configs/rn18-supsup_12.yaml
=> Saving data in runs/SupsupSeed/rn18-supsup_gpu2_num_masks_12/id=supsup~seed=0~sparsity=2~try=2
Files already downloaded and verified
Files already downloaded and verified
[26 86  2 55 75 93 16 73 54 95 53 92 78 13  7 30 22 24 33  8 43 62  3 71
 45 48  6 99 82 76 60 80 90 68 51 27 18 56 63 74  1 61 42 41  4 15 17 40
 38  5 91 59  0 34 28 50 11 35 23 52 10 31 66 57 79 85 32 84 14 89 19 29
 49 97 98 69 20 94 72 77 25 37 81 46 39 65 58 12 88 70 87 36 21 83  9 96
 67 64 47 44]
[26 86  2 55 75]
[93 16 73 54 95]
[53 92 78 13  7]
[30 22 24 33  8]
[43 62  3 71 45]
[48  6 99 82 76]
[60 80 90 68 51]
[27 18 56 63 74]
[ 1 61 42 41  4]
[15 17 40 38  5]
[91 59  0 34 28]
[50 11 35 23 52]
Set sparsity of conv1 to 0.08518518518518518
Set sparsity of layer1.0.conv1 to 0.022222222222222223
Set sparsity of layer1.0.conv2 to 0.022222222222222223
Set sparsity of layer1.1.conv1 to 0.022222222222222223
Set sparsity of layer1.1.conv2 to 0.022222222222222223
Set sparsity of layer2.0.conv1 to 0.016666666666666666
Set sparsity of layer2.0.conv2 to 0.011111111111111112
Set sparsity of layer2.0.shortcut.0 to 0.15
Set sparsity of layer2.1.conv1 to 0.011111111111111112
Set sparsity of layer2.1.conv2 to 0.011111111111111112
Set sparsity of layer3.0.conv1 to 0.008333333333333333
Set sparsity of layer3.0.conv2 to 0.005555555555555556
Set sparsity of layer3.0.shortcut.0 to 0.075
Set sparsity of layer3.1.conv1 to 0.005555555555555556
Set sparsity of layer3.1.conv2 to 0.005555555555555556
Set sparsity of layer4.0.conv1 to 0.004166666666666667
Set sparsity of layer4.0.conv2 to 0.002777777777777778
Set sparsity of layer4.0.shortcut.0 to 0.0375
Set sparsity of layer4.1.conv1 to 0.002777777777777778
Set sparsity of layer4.1.conv2 to 0.002777777777777778
Set sparsity of linear to 0.4125
=> Parallelizing on [2] gpus
Traceback (most recent call last):
  File "main.py", line 425, in <module>
    main()
  File "main.py", line 81, in main
    model = utils.set_gpu(model)
  File "/home/at2507/supsup_team/supsup/utils.py", line 93, in set_gpu
    torch.cuda.set_device(args.multigpu[0])
  File "/home/at2507/miniconda3/lib/python3.8/site-packages/torch/cuda/__init__.py", line 245, in set_device
    torch._C._cuda_setDevice(device)
RuntimeError: cuda runtime error (101) : invalid device ordinal at /pytorch/torch/csrc/cuda/Module.cpp:59
THCudaCheck FAIL file=/pytorch/torch/csrc/cuda/Module.cpp line=59 error=101 : invalid device ordinal
=> Reading YAML config from experiments/SupsupSeed/splitcifar100/configs/rn18-supsup_12.yaml
=> Saving data in runs/SupsupSeed/rn18-supsup_gpu2_num_masks_12/id=supsup~seed=0~sparsity=4~try=2
Files already downloaded and verified
Files already downloaded and verified
[26 86  2 55 75 93 16 73 54 95 53 92 78 13  7 30 22 24 33  8 43 62  3 71
 45 48  6 99 82 76 60 80 90 68 51 27 18 56 63 74  1 61 42 41  4 15 17 40
 38  5 91 59  0 34 28 50 11 35 23 52 10 31 66 57 79 85 32 84 14 89 19 29
 49 97 98 69 20 94 72 77 25 37 81 46 39 65 58 12 88 70 87 36 21 83  9 96
 67 64 47 44]
[26 86  2 55 75]
[93 16 73 54 95]
[53 92 78 13  7]
[30 22 24 33  8]
[43 62  3 71 45]
[48  6 99 82 76]
[60 80 90 68 51]
[27 18 56 63 74]
[ 1 61 42 41  4]
[15 17 40 38  5]
[91 59  0 34 28]
[50 11 35 23 52]
Set sparsity of conv1 to 0.17037037037037037
Set sparsity of layer1.0.conv1 to 0.044444444444444446
Set sparsity of layer1.0.conv2 to 0.044444444444444446
Set sparsity of layer1.1.conv1 to 0.044444444444444446
Set sparsity of layer1.1.conv2 to 0.044444444444444446
Set sparsity of layer2.0.conv1 to 0.03333333333333333
Set sparsity of layer2.0.conv2 to 0.022222222222222223
Set sparsity of layer2.0.shortcut.0 to 0.3
Set sparsity of layer2.1.conv1 to 0.022222222222222223
Set sparsity of layer2.1.conv2 to 0.022222222222222223
Set sparsity of layer3.0.conv1 to 0.016666666666666666
Set sparsity of layer3.0.conv2 to 0.011111111111111112
Set sparsity of layer3.0.shortcut.0 to 0.15
Set sparsity of layer3.1.conv1 to 0.011111111111111112
Set sparsity of layer3.1.conv2 to 0.011111111111111112
Set sparsity of layer4.0.conv1 to 0.008333333333333333
Set sparsity of layer4.0.conv2 to 0.005555555555555556
Set sparsity of layer4.0.shortcut.0 to 0.075
Set sparsity of layer4.1.conv1 to 0.005555555555555556
Set sparsity of layer4.1.conv2 to 0.005555555555555556
Set sparsity of linear to 0.5
=> Parallelizing on [2] gpus
Traceback (most recent call last):
  File "main.py", line 425, in <module>
    main()
  File "main.py", line 81, in main
    model = utils.set_gpu(model)
  File "/home/at2507/supsup_team/supsup/utils.py", line 93, in set_gpu
    torch.cuda.set_device(args.multigpu[0])
  File "/home/at2507/miniconda3/lib/python3.8/site-packages/torch/cuda/__init__.py", line 245, in set_device
    torch._C._cuda_setDevice(device)
RuntimeError: cuda runtime error (101) : invalid device ordinal at /pytorch/torch/csrc/cuda/Module.cpp:59
THCudaCheck FAIL file=/pytorch/torch/csrc/cuda/Module.cpp line=59 error=101 : invalid device ordinal
=> Reading YAML config from experiments/SupsupSeed/splitcifar100/configs/rn18-supsup_12.yaml
=> Saving data in runs/SupsupSeed/rn18-supsup_gpu2_num_masks_12/id=supsup~seed=0~sparsity=8~try=2
Files already downloaded and verified
Files already downloaded and verified
[26 86  2 55 75 93 16 73 54 95 53 92 78 13  7 30 22 24 33  8 43 62  3 71
 45 48  6 99 82 76 60 80 90 68 51 27 18 56 63 74  1 61 42 41  4 15 17 40
 38  5 91 59  0 34 28 50 11 35 23 52 10 31 66 57 79 85 32 84 14 89 19 29
 49 97 98 69 20 94 72 77 25 37 81 46 39 65 58 12 88 70 87 36 21 83  9 96
 67 64 47 44]
[26 86  2 55 75]
[93 16 73 54 95]
[53 92 78 13  7]
[30 22 24 33  8]
[43 62  3 71 45]
[48  6 99 82 76]
[60 80 90 68 51]
[27 18 56 63 74]
[ 1 61 42 41  4]
[15 17 40 38  5]
[91 59  0 34 28]
[50 11 35 23 52]
Set sparsity of conv1 to 0.34074074074074073
Set sparsity of layer1.0.conv1 to 0.08888888888888889
Set sparsity of layer1.0.conv2 to 0.08888888888888889
Set sparsity of layer1.1.conv1 to 0.08888888888888889
Set sparsity of layer1.1.conv2 to 0.08888888888888889
Set sparsity of layer2.0.conv1 to 0.06666666666666667
Set sparsity of layer2.0.conv2 to 0.044444444444444446
Set sparsity of layer2.0.shortcut.0 to 0.5
Set sparsity of layer2.1.conv1 to 0.044444444444444446
Set sparsity of layer2.1.conv2 to 0.044444444444444446
Set sparsity of layer3.0.conv1 to 0.03333333333333333
Set sparsity of layer3.0.conv2 to 0.022222222222222223
Set sparsity of layer3.0.shortcut.0 to 0.3
Set sparsity of layer3.1.conv1 to 0.022222222222222223
Set sparsity of layer3.1.conv2 to 0.022222222222222223
Set sparsity of layer4.0.conv1 to 0.016666666666666666
Set sparsity of layer4.0.conv2 to 0.011111111111111112
Set sparsity of layer4.0.shortcut.0 to 0.15
Set sparsity of layer4.1.conv1 to 0.011111111111111112
Set sparsity of layer4.1.conv2 to 0.011111111111111112
Set sparsity of linear to 0.5
=> Parallelizing on [2] gpus
Traceback (most recent call last):
  File "main.py", line 425, in <module>
    main()
  File "main.py", line 81, in main
    model = utils.set_gpu(model)
  File "/home/at2507/supsup_team/supsup/utils.py", line 93, in set_gpu
    torch.cuda.set_device(args.multigpu[0])
  File "/home/at2507/miniconda3/lib/python3.8/site-packages/torch/cuda/__init__.py", line 245, in set_device
    torch._C._cuda_setDevice(device)
RuntimeError: cuda runtime error (101) : invalid device ordinal at /pytorch/torch/csrc/cuda/Module.cpp:59
THCudaCheck FAIL file=/pytorch/torch/csrc/cuda/Module.cpp line=59 error=101 : invalid device ordinal
=> Reading YAML config from experiments/SupsupSeed/splitcifar100/configs/rn18-supsup_12.yaml
=> Saving data in runs/SupsupSeed/rn18-supsup_gpu2_num_masks_12/id=supsup~seed=0~sparsity=16~try=2
Files already downloaded and verified
Files already downloaded and verified
[26 86  2 55 75 93 16 73 54 95 53 92 78 13  7 30 22 24 33  8 43 62  3 71
 45 48  6 99 82 76 60 80 90 68 51 27 18 56 63 74  1 61 42 41  4 15 17 40
 38  5 91 59  0 34 28 50 11 35 23 52 10 31 66 57 79 85 32 84 14 89 19 29
 49 97 98 69 20 94 72 77 25 37 81 46 39 65 58 12 88 70 87 36 21 83  9 96
 67 64 47 44]
[26 86  2 55 75]
[93 16 73 54 95]
[53 92 78 13  7]
[30 22 24 33  8]
[43 62  3 71 45]
[48  6 99 82 76]
[60 80 90 68 51]
[27 18 56 63 74]
[ 1 61 42 41  4]
[15 17 40 38  5]
[91 59  0 34 28]
[50 11 35 23 52]
Set sparsity of conv1 to 0.5
Set sparsity of layer1.0.conv1 to 0.17777777777777778
Set sparsity of layer1.0.conv2 to 0.17777777777777778
Set sparsity of layer1.1.conv1 to 0.17777777777777778
Set sparsity of layer1.1.conv2 to 0.17777777777777778
Set sparsity of layer2.0.conv1 to 0.13333333333333333
Set sparsity of layer2.0.conv2 to 0.08888888888888889
Set sparsity of layer2.0.shortcut.0 to 0.5
Set sparsity of layer2.1.conv1 to 0.08888888888888889
Set sparsity of layer2.1.conv2 to 0.08888888888888889
Set sparsity of layer3.0.conv1 to 0.06666666666666667
Set sparsity of layer3.0.conv2 to 0.044444444444444446
Set sparsity of layer3.0.shortcut.0 to 0.5
Set sparsity of layer3.1.conv1 to 0.044444444444444446
Set sparsity of layer3.1.conv2 to 0.044444444444444446
Set sparsity of layer4.0.conv1 to 0.03333333333333333
Set sparsity of layer4.0.conv2 to 0.022222222222222223
Set sparsity of layer4.0.shortcut.0 to 0.3
Set sparsity of layer4.1.conv1 to 0.022222222222222223
Set sparsity of layer4.1.conv2 to 0.022222222222222223
Set sparsity of linear to 0.5
=> Parallelizing on [2] gpus
Traceback (most recent call last):
  File "main.py", line 425, in <module>
    main()
  File "main.py", line 81, in main
    model = utils.set_gpu(model)
  File "/home/at2507/supsup_team/supsup/utils.py", line 93, in set_gpu
    torch.cuda.set_device(args.multigpu[0])
  File "/home/at2507/miniconda3/lib/python3.8/site-packages/torch/cuda/__init__.py", line 245, in set_device
    torch._C._cuda_setDevice(device)
RuntimeError: cuda runtime error (101) : invalid device ordinal at /pytorch/torch/csrc/cuda/Module.cpp:59
THCudaCheck FAIL file=/pytorch/torch/csrc/cuda/Module.cpp line=59 error=101 : invalid device ordinal
=> Reading YAML config from experiments/SupsupSeed/splitcifar100/configs/rn18-supsup_12.yaml
=> Saving data in runs/SupsupSeed/rn18-supsup_gpu2_num_masks_12/id=supsup~seed=0~sparsity=32~try=2
Files already downloaded and verified
Files already downloaded and verified
[26 86  2 55 75 93 16 73 54 95 53 92 78 13  7 30 22 24 33  8 43 62  3 71
 45 48  6 99 82 76 60 80 90 68 51 27 18 56 63 74  1 61 42 41  4 15 17 40
 38  5 91 59  0 34 28 50 11 35 23 52 10 31 66 57 79 85 32 84 14 89 19 29
 49 97 98 69 20 94 72 77 25 37 81 46 39 65 58 12 88 70 87 36 21 83  9 96
 67 64 47 44]
[26 86  2 55 75]
[93 16 73 54 95]
[53 92 78 13  7]
[30 22 24 33  8]
[43 62  3 71 45]
[48  6 99 82 76]
[60 80 90 68 51]
[27 18 56 63 74]
[ 1 61 42 41  4]
[15 17 40 38  5]
[91 59  0 34 28]
[50 11 35 23 52]
Set sparsity of conv1 to 0.5
Set sparsity of layer1.0.conv1 to 0.35555555555555557
Set sparsity of layer1.0.conv2 to 0.35555555555555557
Set sparsity of layer1.1.conv1 to 0.35555555555555557
Set sparsity of layer1.1.conv2 to 0.35555555555555557
Set sparsity of layer2.0.conv1 to 0.26666666666666666
Set sparsity of layer2.0.conv2 to 0.17777777777777778
Set sparsity of layer2.0.shortcut.0 to 0.5
Set sparsity of layer2.1.conv1 to 0.17777777777777778
Set sparsity of layer2.1.conv2 to 0.17777777777777778
Set sparsity of layer3.0.conv1 to 0.13333333333333333
Set sparsity of layer3.0.conv2 to 0.08888888888888889
Set sparsity of layer3.0.shortcut.0 to 0.5
Set sparsity of layer3.1.conv1 to 0.08888888888888889
Set sparsity of layer3.1.conv2 to 0.08888888888888889
Set sparsity of layer4.0.conv1 to 0.06666666666666667
Set sparsity of layer4.0.conv2 to 0.044444444444444446
Set sparsity of layer4.0.shortcut.0 to 0.5
Set sparsity of layer4.1.conv1 to 0.044444444444444446
Set sparsity of layer4.1.conv2 to 0.044444444444444446
Set sparsity of linear to 0.5
=> Parallelizing on [2] gpus
Traceback (most recent call last):
  File "main.py", line 425, in <module>
    main()
  File "main.py", line 81, in main
    model = utils.set_gpu(model)
  File "/home/at2507/supsup_team/supsup/utils.py", line 93, in set_gpu
    torch.cuda.set_device(args.multigpu[0])
  File "/home/at2507/miniconda3/lib/python3.8/site-packages/torch/cuda/__init__.py", line 245, in set_device
    torch._C._cuda_setDevice(device)
RuntimeError: cuda runtime error (101) : invalid device ordinal at /pytorch/torch/csrc/cuda/Module.cpp:59
==> Starting experiment python main.py --config=experiments/SupsupSeed/splitcifar100/configs/rn18-supsup_12.yaml --name=id=supsup~seed=0~sparsity=1 --sparsity=1 --seed=0 --log-dir=runs/SupsupSeed/rn18-supsup_gpu2_num_masks_12 --epochs=250 --data=./data --multigpu=2 
==> Starting experiment python main.py --config=experiments/SupsupSeed/splitcifar100/configs/rn18-supsup_12.yaml --name=id=supsup~seed=0~sparsity=2 --sparsity=2 --seed=0 --log-dir=runs/SupsupSeed/rn18-supsup_gpu2_num_masks_12 --epochs=250 --data=./data --multigpu=2 
==> Starting experiment python main.py --config=experiments/SupsupSeed/splitcifar100/configs/rn18-supsup_12.yaml --name=id=supsup~seed=0~sparsity=4 --sparsity=4 --seed=0 --log-dir=runs/SupsupSeed/rn18-supsup_gpu2_num_masks_12 --epochs=250 --data=./data --multigpu=2 
==> Starting experiment python main.py --config=experiments/SupsupSeed/splitcifar100/configs/rn18-supsup_12.yaml --name=id=supsup~seed=0~sparsity=8 --sparsity=8 --seed=0 --log-dir=runs/SupsupSeed/rn18-supsup_gpu2_num_masks_12 --epochs=250 --data=./data --multigpu=2 
==> Starting experiment python main.py --config=experiments/SupsupSeed/splitcifar100/configs/rn18-supsup_12.yaml --name=id=supsup~seed=0~sparsity=16 --sparsity=16 --seed=0 --log-dir=runs/SupsupSeed/rn18-supsup_gpu2_num_masks_12 --epochs=250 --data=./data --multigpu=2 
==> Starting experiment python main.py --config=experiments/SupsupSeed/splitcifar100/configs/rn18-supsup_12.yaml --name=id=supsup~seed=0~sparsity=32 --sparsity=32 --seed=0 --log-dir=runs/SupsupSeed/rn18-supsup_gpu2_num_masks_12 --epochs=250 --data=./data --multigpu=2 
[{'config': 'experiments/SupsupSeed/splitcifar100/configs/rn18-supsup_15.yaml', 'name': 'id=supsup~seed=0~sparsity=1', 'sparsity': 1, 'seed': 0, 'log-dir': 'runs/SupsupSeed/rn18-supsup_gpu2_num_masks_15', 'epochs': 250, 'data': './data'}, {'config': 'experiments/SupsupSeed/splitcifar100/configs/rn18-supsup_15.yaml', 'name': 'id=supsup~seed=0~sparsity=2', 'sparsity': 2, 'seed': 0, 'log-dir': 'runs/SupsupSeed/rn18-supsup_gpu2_num_masks_15', 'epochs': 250, 'data': './data'}, {'config': 'experiments/SupsupSeed/splitcifar100/configs/rn18-supsup_15.yaml', 'name': 'id=supsup~seed=0~sparsity=4', 'sparsity': 4, 'seed': 0, 'log-dir': 'runs/SupsupSeed/rn18-supsup_gpu2_num_masks_15', 'epochs': 250, 'data': './data'}, {'config': 'experiments/SupsupSeed/splitcifar100/configs/rn18-supsup_15.yaml', 'name': 'id=supsup~seed=0~sparsity=8', 'sparsity': 8, 'seed': 0, 'log-dir': 'runs/SupsupSeed/rn18-supsup_gpu2_num_masks_15', 'epochs': 250, 'data': './data'}, {'config': 'experiments/SupsupSeed/splitcifar100/configs/rn18-supsup_15.yaml', 'name': 'id=supsup~seed=0~sparsity=16', 'sparsity': 16, 'seed': 0, 'log-dir': 'runs/SupsupSeed/rn18-supsup_gpu2_num_masks_15', 'epochs': 250, 'data': './data'}, {'config': 'experiments/SupsupSeed/splitcifar100/configs/rn18-supsup_15.yaml', 'name': 'id=supsup~seed=0~sparsity=32', 'sparsity': 32, 'seed': 0, 'log-dir': 'runs/SupsupSeed/rn18-supsup_gpu2_num_masks_15', 'epochs': 250, 'data': './data'}]
THCudaCheck FAIL file=/pytorch/torch/csrc/cuda/Module.cpp line=59 error=101 : invalid device ordinal
=> Reading YAML config from experiments/SupsupSeed/splitcifar100/configs/rn18-supsup_15.yaml
=> Saving data in runs/SupsupSeed/rn18-supsup_gpu2_num_masks_15/id=supsup~seed=0~sparsity=1~try=2
Files already downloaded and verified
Files already downloaded and verified
[26 86  2 55 75 93 16 73 54 95 53 92 78 13  7 30 22 24 33  8 43 62  3 71
 45 48  6 99 82 76 60 80 90 68 51 27 18 56 63 74  1 61 42 41  4 15 17 40
 38  5 91 59  0 34 28 50 11 35 23 52 10 31 66 57 79 85 32 84 14 89 19 29
 49 97 98 69 20 94 72 77 25 37 81 46 39 65 58 12 88 70 87 36 21 83  9 96
 67 64 47 44]
[26 86  2 55 75]
[93 16 73 54 95]
[53 92 78 13  7]
[30 22 24 33  8]
[43 62  3 71 45]
[48  6 99 82 76]
[60 80 90 68 51]
[27 18 56 63 74]
[ 1 61 42 41  4]
[15 17 40 38  5]
[91 59  0 34 28]
[50 11 35 23 52]
[10 31 66 57 79]
[85 32 84 14 89]
[19 29 49 97 98]
Set sparsity of conv1 to 0.04259259259259259
Set sparsity of layer1.0.conv1 to 0.011111111111111112
Set sparsity of layer1.0.conv2 to 0.011111111111111112
Set sparsity of layer1.1.conv1 to 0.011111111111111112
Set sparsity of layer1.1.conv2 to 0.011111111111111112
Set sparsity of layer2.0.conv1 to 0.008333333333333333
Set sparsity of layer2.0.conv2 to 0.005555555555555556
Set sparsity of layer2.0.shortcut.0 to 0.075
Set sparsity of layer2.1.conv1 to 0.005555555555555556
Set sparsity of layer2.1.conv2 to 0.005555555555555556
Set sparsity of layer3.0.conv1 to 0.004166666666666667
Set sparsity of layer3.0.conv2 to 0.002777777777777778
Set sparsity of layer3.0.shortcut.0 to 0.0375
Set sparsity of layer3.1.conv1 to 0.002777777777777778
Set sparsity of layer3.1.conv2 to 0.002777777777777778
Set sparsity of layer4.0.conv1 to 0.0020833333333333333
Set sparsity of layer4.0.conv2 to 0.001388888888888889
Set sparsity of layer4.0.shortcut.0 to 0.01875
Set sparsity of layer4.1.conv1 to 0.001388888888888889
Set sparsity of layer4.1.conv2 to 0.001388888888888889
Set sparsity of linear to 0.20625
=> Parallelizing on [2] gpus
Traceback (most recent call last):
  File "main.py", line 425, in <module>
    main()
  File "main.py", line 81, in main
    model = utils.set_gpu(model)
  File "/home/at2507/supsup_team/supsup/utils.py", line 93, in set_gpu
    torch.cuda.set_device(args.multigpu[0])
  File "/home/at2507/miniconda3/lib/python3.8/site-packages/torch/cuda/__init__.py", line 245, in set_device
    torch._C._cuda_setDevice(device)
RuntimeError: cuda runtime error (101) : invalid device ordinal at /pytorch/torch/csrc/cuda/Module.cpp:59
THCudaCheck FAIL file=/pytorch/torch/csrc/cuda/Module.cpp line=59 error=101 : invalid device ordinal
=> Reading YAML config from experiments/SupsupSeed/splitcifar100/configs/rn18-supsup_15.yaml
=> Saving data in runs/SupsupSeed/rn18-supsup_gpu2_num_masks_15/id=supsup~seed=0~sparsity=2~try=2
Files already downloaded and verified
Files already downloaded and verified
[26 86  2 55 75 93 16 73 54 95 53 92 78 13  7 30 22 24 33  8 43 62  3 71
 45 48  6 99 82 76 60 80 90 68 51 27 18 56 63 74  1 61 42 41  4 15 17 40
 38  5 91 59  0 34 28 50 11 35 23 52 10 31 66 57 79 85 32 84 14 89 19 29
 49 97 98 69 20 94 72 77 25 37 81 46 39 65 58 12 88 70 87 36 21 83  9 96
 67 64 47 44]
[26 86  2 55 75]
[93 16 73 54 95]
[53 92 78 13  7]
[30 22 24 33  8]
[43 62  3 71 45]
[48  6 99 82 76]
[60 80 90 68 51]
[27 18 56 63 74]
[ 1 61 42 41  4]
[15 17 40 38  5]
[91 59  0 34 28]
[50 11 35 23 52]
[10 31 66 57 79]
[85 32 84 14 89]
[19 29 49 97 98]
Set sparsity of conv1 to 0.08518518518518518
Set sparsity of layer1.0.conv1 to 0.022222222222222223
Set sparsity of layer1.0.conv2 to 0.022222222222222223
Set sparsity of layer1.1.conv1 to 0.022222222222222223
Set sparsity of layer1.1.conv2 to 0.022222222222222223
Set sparsity of layer2.0.conv1 to 0.016666666666666666
Set sparsity of layer2.0.conv2 to 0.011111111111111112
Set sparsity of layer2.0.shortcut.0 to 0.15
Set sparsity of layer2.1.conv1 to 0.011111111111111112
Set sparsity of layer2.1.conv2 to 0.011111111111111112
Set sparsity of layer3.0.conv1 to 0.008333333333333333
Set sparsity of layer3.0.conv2 to 0.005555555555555556
Set sparsity of layer3.0.shortcut.0 to 0.075
Set sparsity of layer3.1.conv1 to 0.005555555555555556
Set sparsity of layer3.1.conv2 to 0.005555555555555556
Set sparsity of layer4.0.conv1 to 0.004166666666666667
Set sparsity of layer4.0.conv2 to 0.002777777777777778
Set sparsity of layer4.0.shortcut.0 to 0.0375
Set sparsity of layer4.1.conv1 to 0.002777777777777778
Set sparsity of layer4.1.conv2 to 0.002777777777777778
Set sparsity of linear to 0.4125
=> Parallelizing on [2] gpus
Traceback (most recent call last):
  File "main.py", line 425, in <module>
    main()
  File "main.py", line 81, in main
    model = utils.set_gpu(model)
  File "/home/at2507/supsup_team/supsup/utils.py", line 93, in set_gpu
    torch.cuda.set_device(args.multigpu[0])
  File "/home/at2507/miniconda3/lib/python3.8/site-packages/torch/cuda/__init__.py", line 245, in set_device
    torch._C._cuda_setDevice(device)
RuntimeError: cuda runtime error (101) : invalid device ordinal at /pytorch/torch/csrc/cuda/Module.cpp:59
THCudaCheck FAIL file=/pytorch/torch/csrc/cuda/Module.cpp line=59 error=101 : invalid device ordinal
=> Reading YAML config from experiments/SupsupSeed/splitcifar100/configs/rn18-supsup_15.yaml
=> Saving data in runs/SupsupSeed/rn18-supsup_gpu2_num_masks_15/id=supsup~seed=0~sparsity=4~try=2
Files already downloaded and verified
Files already downloaded and verified
[26 86  2 55 75 93 16 73 54 95 53 92 78 13  7 30 22 24 33  8 43 62  3 71
 45 48  6 99 82 76 60 80 90 68 51 27 18 56 63 74  1 61 42 41  4 15 17 40
 38  5 91 59  0 34 28 50 11 35 23 52 10 31 66 57 79 85 32 84 14 89 19 29
 49 97 98 69 20 94 72 77 25 37 81 46 39 65 58 12 88 70 87 36 21 83  9 96
 67 64 47 44]
[26 86  2 55 75]
[93 16 73 54 95]
[53 92 78 13  7]
[30 22 24 33  8]
[43 62  3 71 45]
[48  6 99 82 76]
[60 80 90 68 51]
[27 18 56 63 74]
[ 1 61 42 41  4]
[15 17 40 38  5]
[91 59  0 34 28]
[50 11 35 23 52]
[10 31 66 57 79]
[85 32 84 14 89]
[19 29 49 97 98]
Set sparsity of conv1 to 0.17037037037037037
Set sparsity of layer1.0.conv1 to 0.044444444444444446
Set sparsity of layer1.0.conv2 to 0.044444444444444446
Set sparsity of layer1.1.conv1 to 0.044444444444444446
Set sparsity of layer1.1.conv2 to 0.044444444444444446
Set sparsity of layer2.0.conv1 to 0.03333333333333333
Set sparsity of layer2.0.conv2 to 0.022222222222222223
Set sparsity of layer2.0.shortcut.0 to 0.3
Set sparsity of layer2.1.conv1 to 0.022222222222222223
Set sparsity of layer2.1.conv2 to 0.022222222222222223
Set sparsity of layer3.0.conv1 to 0.016666666666666666
Set sparsity of layer3.0.conv2 to 0.011111111111111112
Set sparsity of layer3.0.shortcut.0 to 0.15
Set sparsity of layer3.1.conv1 to 0.011111111111111112
Set sparsity of layer3.1.conv2 to 0.011111111111111112
Set sparsity of layer4.0.conv1 to 0.008333333333333333
Set sparsity of layer4.0.conv2 to 0.005555555555555556
Set sparsity of layer4.0.shortcut.0 to 0.075
Set sparsity of layer4.1.conv1 to 0.005555555555555556
Set sparsity of layer4.1.conv2 to 0.005555555555555556
Set sparsity of linear to 0.5
=> Parallelizing on [2] gpus
Traceback (most recent call last):
  File "main.py", line 425, in <module>
    main()
  File "main.py", line 81, in main
    model = utils.set_gpu(model)
  File "/home/at2507/supsup_team/supsup/utils.py", line 93, in set_gpu
    torch.cuda.set_device(args.multigpu[0])
  File "/home/at2507/miniconda3/lib/python3.8/site-packages/torch/cuda/__init__.py", line 245, in set_device
    torch._C._cuda_setDevice(device)
RuntimeError: cuda runtime error (101) : invalid device ordinal at /pytorch/torch/csrc/cuda/Module.cpp:59
THCudaCheck FAIL file=/pytorch/torch/csrc/cuda/Module.cpp line=59 error=101 : invalid device ordinal
=> Reading YAML config from experiments/SupsupSeed/splitcifar100/configs/rn18-supsup_15.yaml
=> Saving data in runs/SupsupSeed/rn18-supsup_gpu2_num_masks_15/id=supsup~seed=0~sparsity=8~try=2
Files already downloaded and verified
Files already downloaded and verified
[26 86  2 55 75 93 16 73 54 95 53 92 78 13  7 30 22 24 33  8 43 62  3 71
 45 48  6 99 82 76 60 80 90 68 51 27 18 56 63 74  1 61 42 41  4 15 17 40
 38  5 91 59  0 34 28 50 11 35 23 52 10 31 66 57 79 85 32 84 14 89 19 29
 49 97 98 69 20 94 72 77 25 37 81 46 39 65 58 12 88 70 87 36 21 83  9 96
 67 64 47 44]
[26 86  2 55 75]
[93 16 73 54 95]
[53 92 78 13  7]
[30 22 24 33  8]
[43 62  3 71 45]
[48  6 99 82 76]
[60 80 90 68 51]
[27 18 56 63 74]
[ 1 61 42 41  4]
[15 17 40 38  5]
[91 59  0 34 28]
[50 11 35 23 52]
[10 31 66 57 79]
[85 32 84 14 89]
[19 29 49 97 98]
Set sparsity of conv1 to 0.34074074074074073
Set sparsity of layer1.0.conv1 to 0.08888888888888889
Set sparsity of layer1.0.conv2 to 0.08888888888888889
Set sparsity of layer1.1.conv1 to 0.08888888888888889
Set sparsity of layer1.1.conv2 to 0.08888888888888889
Set sparsity of layer2.0.conv1 to 0.06666666666666667
Set sparsity of layer2.0.conv2 to 0.044444444444444446
Set sparsity of layer2.0.shortcut.0 to 0.5
Set sparsity of layer2.1.conv1 to 0.044444444444444446
Set sparsity of layer2.1.conv2 to 0.044444444444444446
Set sparsity of layer3.0.conv1 to 0.03333333333333333
Set sparsity of layer3.0.conv2 to 0.022222222222222223
Set sparsity of layer3.0.shortcut.0 to 0.3
Set sparsity of layer3.1.conv1 to 0.022222222222222223
Set sparsity of layer3.1.conv2 to 0.022222222222222223
Set sparsity of layer4.0.conv1 to 0.016666666666666666
Set sparsity of layer4.0.conv2 to 0.011111111111111112
Set sparsity of layer4.0.shortcut.0 to 0.15
Set sparsity of layer4.1.conv1 to 0.011111111111111112
Set sparsity of layer4.1.conv2 to 0.011111111111111112
Set sparsity of linear to 0.5
=> Parallelizing on [2] gpus
Traceback (most recent call last):
  File "main.py", line 425, in <module>
    main()
  File "main.py", line 81, in main
    model = utils.set_gpu(model)
  File "/home/at2507/supsup_team/supsup/utils.py", line 93, in set_gpu
    torch.cuda.set_device(args.multigpu[0])
  File "/home/at2507/miniconda3/lib/python3.8/site-packages/torch/cuda/__init__.py", line 245, in set_device
    torch._C._cuda_setDevice(device)
RuntimeError: cuda runtime error (101) : invalid device ordinal at /pytorch/torch/csrc/cuda/Module.cpp:59
THCudaCheck FAIL file=/pytorch/torch/csrc/cuda/Module.cpp line=59 error=101 : invalid device ordinal
=> Reading YAML config from experiments/SupsupSeed/splitcifar100/configs/rn18-supsup_15.yaml
=> Saving data in runs/SupsupSeed/rn18-supsup_gpu2_num_masks_15/id=supsup~seed=0~sparsity=16~try=2
Files already downloaded and verified
Files already downloaded and verified
[26 86  2 55 75 93 16 73 54 95 53 92 78 13  7 30 22 24 33  8 43 62  3 71
 45 48  6 99 82 76 60 80 90 68 51 27 18 56 63 74  1 61 42 41  4 15 17 40
 38  5 91 59  0 34 28 50 11 35 23 52 10 31 66 57 79 85 32 84 14 89 19 29
 49 97 98 69 20 94 72 77 25 37 81 46 39 65 58 12 88 70 87 36 21 83  9 96
 67 64 47 44]
[26 86  2 55 75]
[93 16 73 54 95]
[53 92 78 13  7]
[30 22 24 33  8]
[43 62  3 71 45]
[48  6 99 82 76]
[60 80 90 68 51]
[27 18 56 63 74]
[ 1 61 42 41  4]
[15 17 40 38  5]
[91 59  0 34 28]
[50 11 35 23 52]
[10 31 66 57 79]
[85 32 84 14 89]
[19 29 49 97 98]
Set sparsity of conv1 to 0.5
Set sparsity of layer1.0.conv1 to 0.17777777777777778
Set sparsity of layer1.0.conv2 to 0.17777777777777778
Set sparsity of layer1.1.conv1 to 0.17777777777777778
Set sparsity of layer1.1.conv2 to 0.17777777777777778
Set sparsity of layer2.0.conv1 to 0.13333333333333333
Set sparsity of layer2.0.conv2 to 0.08888888888888889
Set sparsity of layer2.0.shortcut.0 to 0.5
Set sparsity of layer2.1.conv1 to 0.08888888888888889
Set sparsity of layer2.1.conv2 to 0.08888888888888889
Set sparsity of layer3.0.conv1 to 0.06666666666666667
Set sparsity of layer3.0.conv2 to 0.044444444444444446
Set sparsity of layer3.0.shortcut.0 to 0.5
Set sparsity of layer3.1.conv1 to 0.044444444444444446
Set sparsity of layer3.1.conv2 to 0.044444444444444446
Set sparsity of layer4.0.conv1 to 0.03333333333333333
Set sparsity of layer4.0.conv2 to 0.022222222222222223
Set sparsity of layer4.0.shortcut.0 to 0.3
Set sparsity of layer4.1.conv1 to 0.022222222222222223
Set sparsity of layer4.1.conv2 to 0.022222222222222223
Set sparsity of linear to 0.5
=> Parallelizing on [2] gpus
Traceback (most recent call last):
  File "main.py", line 425, in <module>
    main()
  File "main.py", line 81, in main
    model = utils.set_gpu(model)
  File "/home/at2507/supsup_team/supsup/utils.py", line 93, in set_gpu
    torch.cuda.set_device(args.multigpu[0])
  File "/home/at2507/miniconda3/lib/python3.8/site-packages/torch/cuda/__init__.py", line 245, in set_device
    torch._C._cuda_setDevice(device)
RuntimeError: cuda runtime error (101) : invalid device ordinal at /pytorch/torch/csrc/cuda/Module.cpp:59
THCudaCheck FAIL file=/pytorch/torch/csrc/cuda/Module.cpp line=59 error=101 : invalid device ordinal
=> Reading YAML config from experiments/SupsupSeed/splitcifar100/configs/rn18-supsup_15.yaml
=> Saving data in runs/SupsupSeed/rn18-supsup_gpu2_num_masks_15/id=supsup~seed=0~sparsity=32~try=2
Files already downloaded and verified
Files already downloaded and verified
[26 86  2 55 75 93 16 73 54 95 53 92 78 13  7 30 22 24 33  8 43 62  3 71
 45 48  6 99 82 76 60 80 90 68 51 27 18 56 63 74  1 61 42 41  4 15 17 40
 38  5 91 59  0 34 28 50 11 35 23 52 10 31 66 57 79 85 32 84 14 89 19 29
 49 97 98 69 20 94 72 77 25 37 81 46 39 65 58 12 88 70 87 36 21 83  9 96
 67 64 47 44]
[26 86  2 55 75]
[93 16 73 54 95]
[53 92 78 13  7]
[30 22 24 33  8]
[43 62  3 71 45]
[48  6 99 82 76]
[60 80 90 68 51]
[27 18 56 63 74]
[ 1 61 42 41  4]
[15 17 40 38  5]
[91 59  0 34 28]
[50 11 35 23 52]
[10 31 66 57 79]
[85 32 84 14 89]
[19 29 49 97 98]
Set sparsity of conv1 to 0.5
Set sparsity of layer1.0.conv1 to 0.35555555555555557
Set sparsity of layer1.0.conv2 to 0.35555555555555557
Set sparsity of layer1.1.conv1 to 0.35555555555555557
Set sparsity of layer1.1.conv2 to 0.35555555555555557
Set sparsity of layer2.0.conv1 to 0.26666666666666666
Set sparsity of layer2.0.conv2 to 0.17777777777777778
Set sparsity of layer2.0.shortcut.0 to 0.5
Set sparsity of layer2.1.conv1 to 0.17777777777777778
Set sparsity of layer2.1.conv2 to 0.17777777777777778
Set sparsity of layer3.0.conv1 to 0.13333333333333333
Set sparsity of layer3.0.conv2 to 0.08888888888888889
Set sparsity of layer3.0.shortcut.0 to 0.5
Set sparsity of layer3.1.conv1 to 0.08888888888888889
Set sparsity of layer3.1.conv2 to 0.08888888888888889
Set sparsity of layer4.0.conv1 to 0.06666666666666667
Set sparsity of layer4.0.conv2 to 0.044444444444444446
Set sparsity of layer4.0.shortcut.0 to 0.5
Set sparsity of layer4.1.conv1 to 0.044444444444444446
Set sparsity of layer4.1.conv2 to 0.044444444444444446
Set sparsity of linear to 0.5
=> Parallelizing on [2] gpus
Traceback (most recent call last):
  File "main.py", line 425, in <module>
    main()
  File "main.py", line 81, in main
    model = utils.set_gpu(model)
  File "/home/at2507/supsup_team/supsup/utils.py", line 93, in set_gpu
    torch.cuda.set_device(args.multigpu[0])
  File "/home/at2507/miniconda3/lib/python3.8/site-packages/torch/cuda/__init__.py", line 245, in set_device
    torch._C._cuda_setDevice(device)
RuntimeError: cuda runtime error (101) : invalid device ordinal at /pytorch/torch/csrc/cuda/Module.cpp:59
==> Starting experiment python main.py --config=experiments/SupsupSeed/splitcifar100/configs/rn18-supsup_15.yaml --name=id=supsup~seed=0~sparsity=1 --sparsity=1 --seed=0 --log-dir=runs/SupsupSeed/rn18-supsup_gpu2_num_masks_15 --epochs=250 --data=./data --multigpu=2 
==> Starting experiment python main.py --config=experiments/SupsupSeed/splitcifar100/configs/rn18-supsup_15.yaml --name=id=supsup~seed=0~sparsity=2 --sparsity=2 --seed=0 --log-dir=runs/SupsupSeed/rn18-supsup_gpu2_num_masks_15 --epochs=250 --data=./data --multigpu=2 
==> Starting experiment python main.py --config=experiments/SupsupSeed/splitcifar100/configs/rn18-supsup_15.yaml --name=id=supsup~seed=0~sparsity=4 --sparsity=4 --seed=0 --log-dir=runs/SupsupSeed/rn18-supsup_gpu2_num_masks_15 --epochs=250 --data=./data --multigpu=2 
==> Starting experiment python main.py --config=experiments/SupsupSeed/splitcifar100/configs/rn18-supsup_15.yaml --name=id=supsup~seed=0~sparsity=8 --sparsity=8 --seed=0 --log-dir=runs/SupsupSeed/rn18-supsup_gpu2_num_masks_15 --epochs=250 --data=./data --multigpu=2 
==> Starting experiment python main.py --config=experiments/SupsupSeed/splitcifar100/configs/rn18-supsup_15.yaml --name=id=supsup~seed=0~sparsity=16 --sparsity=16 --seed=0 --log-dir=runs/SupsupSeed/rn18-supsup_gpu2_num_masks_15 --epochs=250 --data=./data --multigpu=2 
==> Starting experiment python main.py --config=experiments/SupsupSeed/splitcifar100/configs/rn18-supsup_15.yaml --name=id=supsup~seed=0~sparsity=32 --sparsity=32 --seed=0 --log-dir=runs/SupsupSeed/rn18-supsup_gpu2_num_masks_15 --epochs=250 --data=./data --multigpu=2 
